# 产品服务闭环系统 - 需求文档 (PRD)

**版本**: 0.9.0 (Draft)
**状态**: 待确认
**最后更新**: 2026-02-03

---

## 1. 产品概述

### 1.1 系统定位

**Longhorn** 是 Kinefinity 的**产品服务闭环系统**，以"服务"为核心，连接客户、经销商和公司内部团队，围绕产品建立完整的服务生态。

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          产品服务闭环系统                                 │
│                                                                         │
│                              ┌─────────┐                                │
│                              │  产品   │                                │
│                              └────┬────┘                                │
│                                   │                                     │
│         ┌─────────────────────────┼─────────────────────────┐           │
│         │                         │                         │           │
│         ▼                         ▼                         ▼           │
│   ┌──────────┐             ┌──────────┐             ┌──────────┐        │
│   │   客户    │◄───服务───►│   公司    │◄───协作───►│  经销商   │        │
│   └──────────┘             └──────────┘             └──────────┘        │
│                                  │                                      │
│                   ┌──────────────┼──────────────┐                       │
│                   ▼              ▼              ▼                       │
│             ┌─────────┐   ┌─────────┐   ┌─────────┐                     │
│             │ 市场部   │   │ 生产部   │   │ 研发部   │                     │
│             │ 服务前端 │   │ 服务执行 │   │ 服务改进 │                     │
│             └─────────┘   └─────────┘   └─────────┘                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.2 核心理念：服务驱动

**一切客户交互都是服务**,咨询工单是系统的核心入口：

```
客户联系 → 创建咨询工单 → 服务过程 → 产出
                              │
              ┌───────────────┼───────────────┬───────────────┐
              ▼               ▼               ▼               ▼
         简单咨询        问题排查         产品故障        功能期望
         解答关闭        解决/升级        RMA返厂单       需求管理
                                              ↓               ↓
                                         维修闭环        产品迭代
                                              ↓               ↓
                                         知识沉淀        发布推送
                                              ↓               ↓
                                         ─────────► 客户忠诚度 ◄─────────
```

**服务的四种产出**：

| 服务结果 | 产出类型 | 后续流程 | 价值 |
|---------|---------|---------|------|
| 咨询解答 | 关闭咨询工单 | - | 客户满意 |
| 需要返修 | **RMA返厂单** | 物流→检测→维修→结算 | 产品修复 |
| 功能期望 | **Wishlist** | 评估→规划→开发→发布 | 产品改进 |
| 有价值信息 | **知识点** | 审核→发布 | 知识积累 |

### 1.3 三层工单模型

系统采用**三层工单模型**，清晰区分咨询、返厂维修和经销商本地维修三种场景：

```
┌─────────────────────────────────────────────────────────────────────────┐
│                            三层工单模型                                    │
│                                                                         │
│  ┌───────────────┐      ┌───────────────┐      ┌───────────────┐       │
│  │ 咨询工单 (K)   │      │ RMA返厂单     │      │ 经销商维修单   │       │
│  │               │      │               │      │  (SVC)        │       │
│  │ K2602-0001    │      │ RMA-D-2602-001│      │ SVC-D-2602-001│       │
│  ├───────────────┤      ├───────────────┤      ├───────────────┤       │
│  │ • 咨询解答    │      │ • 设备返厂    │      │ • 本地维修    │       │
│  │ • 问题排查    │ 升级 │ • 检测诊断    │      │ • 配件消耗    │       │
│  │ • 远程协助    │─────▶│ • 维修执行    │      │ • 费用结算    │       │
│  │ • 技术支持    │      │ • 费用结算    │      │ • 经销商处理  │       │
│  │ • 投诉处理    │      │ • 物流跟踪    │      │               │       │
│  └───────────────┘      └───────────────┘      └───────────────┘       │
│       服务入口               返厂维修层              本地维修层           │
└─────────────────────────────────────────────────────────────────────────┘
```

**工单类型定义**：

| 工单类型 | ID格式 | 示例 | 说明 |
|---------|--------|------|------|
| **咨询工单** | KYYMM-XXXX | K2602-0001 | 咨询、问题排查等服务的统一入口 |
| **RMA返厂单** | RMA-{C}-YYMM-XXXX | RMA-D-2602-0015 | 设备返回Kinefinity总部维修，每台设备独立RMA号 |
| **经销商维修单** | SVC-D-YYMM-XXXX | SVC-D-2602-0001 | 经销商本地维修，不寄回总部 |

**编号规则**：
- YYMM：年份后两位 + 月份（如2602=2026年2月）
- XXXX：月度序号，0001-9999为十进制，超过9999自动转16进制(A000-FFFF)
- 每月序号重置，最大容量65535条/月
- RMA中的 {C} 为渠道代码：D=Dealer（经销商），C=Customer（直客）

**RMA购物车提交流程**：

经销商申请返厂时，可批量添加多台设备（购物车模式），提交时系统为每台设备生成独立RMA号：

```
┌─────────────────────────────────────────────────────────────────────────┐
│ 第一步：购物车模式                                                        │
│                                                                         │
│   经销商ProAV添加返厂设备：                                               │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │ [✓] ME8K_SN001  MAVO Edge 8K   问题：死机重启                    │   │
│   │ [✓] ME6K_SN002  MAVO Edge 6K   问题：SDI无输出                   │   │
│   │ [✓] TER_SN003   Terra 4K       问题：开机无反应                   │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                          [ 提交返厂申请 ]                                │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ 第二步：提交瞬间（后端处理）                                              │
│                                                                         │
│   系统为每台设备生成独立RMA号：                                           │
│   • ME8K_SN001 → RMA-D-2602-0001                                       │
│   • ME6K_SN002 → RMA-D-2602-0002                                       │
│   • TER_SN003  → RMA-D-2602-0003                                       │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ 第三步：展示给用户                                                        │
│                                                                         │
│   "提交成功！请打印以下清单放入箱内："                                     │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │ RMA清单                                                         │   │
│   │ ─────────────────────────────────────────────────────────────  │   │
│   │ 1. RMA-D-2602-0001  MAVO Edge 8K (ME8K_SN001)                  │   │
│   │ 2. RMA-D-2602-0002  MAVO Edge 6K (ME6K_SN002)                  │   │
│   │ 3. RMA-D-2602-0003  Terra 4K (TER_SN003)                       │   │
│   │                                                                 │   │
│   │ 发件人: ProAV UK                                                │   │
│   │ 收件人: Kinefinity 深圳总部                                      │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                    [ 下载PDF ] [ 打印清单 ]                              │
└─────────────────────────────────────────────────────────────────────────┘
```

**1.3.1 交互 2.0: 统一创建弹窗 (Unified Modal)**

响应用户反馈，系统重构了工单创建交互，引入了全局统一的 `TicketCreationModal`：

*   **一致性**: 不论是咨询、RMA 还是经销商维修，均在同一 UI 弹窗内完成，保持了视觉和操作的高度一致。
*   **草稿持久化**: 集成 LocalStorage 自动保存机制，用户关闭弹窗或刷新页面后，再次打开可一键恢复未填写的草稿。
*   **媒体即地上传**: 支持拖拽上传图片和视频，实时生成缩略图预览。

---

**渠道代码**：
| 代码 | 含义 |
|------|------|
| D | Dealer (经销商) |
| C | Customer (直客) |

### 1.4 参与者与服务职责

#### 1.4.1 外部参与者

**终端客户 (End Customer)**
| 身份 | 服务场景 | 系统交互 |
|-----|---------|---------|
| 产品购买者 | 咨询使用问题、反馈故障、提出期望 | 通过经销商或市场部联系 |
| KOL/媒体 | 测评问题、功能建议 | 同上，优先级可能更高 |

**案例**：
> 客户Max购买了MAVO Edge 8K，使用中遇到死机问题。
> - 联系经销商ProAV反馈问题
> - 经销商创建咨询工单，引导排查
> - 排查无效 → 升级为RMA返厂单
> - 维修完成后，Max收到取件通知
> - Max在服务中提到"希望支持快速启动" → 记录为功能期望

#### 1.4.2 合作伙伴

**经销商 (Dealer)** - 服务的延伸和中介

| 分级 | 代表 | 服务能力 | 典型场景 |
|-----|------|---------|---------|
| **一级** | ProAV(英国), Gafpa(欧洲), 1SV(美国) | 有库存+强维修能力 | 本地维修、配件更换、代客户反馈 |
| **二级** | DP Gadget(东南亚) | 有维修能力无库存 | 申请配件后本地维修 |
| **三级** | RMK(澳洲) | 无维修能力 | 代客户反馈、协调寄回总部 |

**案例 - 一级经销商(ProAV)**：
> 1. 客户反馈Edge死机问题
> 2. ProAV创建咨询工单，引导客户排查
> 3. 确认需更换SDI模块 → 使用库存配件本地维修
> 4. 库存消耗记录到系统，月底统一结算
> 5. 库存低于安全线 → 系统自动提醒补货

**案例 - 三级经销商(RMK)**：
> 1. 澳洲客户反馈问题
> 2. RMK创建咨询工单，无法本地处理
> 3. 协调客户寄回深圳总部
> 4. 总部维修完成后寄回
> 5. RMK全程跟踪状态，同步给客户

#### 1.4.3 内部团队

**市场部 - 服务前端**

| 人员 | 职责区域 | 服务场景 |
|-----|---------|---------|
| Effy | 海外市场 | 处理海外工单、协调经销商、客户沟通 |
| 李雨健 | 国内市场 | 处理国内工单、直接对接客户 |
| Sherry | 负责人 | 审批异常、查看报表、处理升级 |
| Cathy | 负责人 | 审批异常、查看报表、处理升级 |

**案例 - Effy处理海外工单**：
> 1. 收到ProAV提交的工单推送 (iOS)
> 2. 快速查看问题描述，判断优先级
> 3. 查询知识库，回复处理建议
> 4. 需要返修 → 协调RMA流程
> 5. 跟踪物流状态，通知经销商收货时间
> 6. 维修完成 → 确认结算，关闭工单

**生产部 - 服务执行**

| 人员 | 职责 | 服务场景 |
|-----|------|---------|
| 黄碧珊 | 负责人 | 分配任务、审核报告、处理异常 |
| 陈高松/张工/张平娇 | 维修技师 | 执行维修、填写分析报告 |

**案例 - 生产部处理返修**：
> 1. 收到新返修任务推送
> 2. 收货登记，开始检测
> 3. 发现问题：SDI模块损坏 + 主板有腐蚀痕迹
> 4. 实际费用超预估 → 提交异常报告
> 5. 等待客户确认 → 继续维修
> 6. 维修完成 → 填写维修内容和问题分析
> 7. AI建议：可沉淀为知识点 → 确认发布

**研发部 - 服务改进**

| 人员 | 职责 | 服务场景 |
|-----|------|---------|
| 吴琪萌 | 产品 | 分析问题趋势、评估功能期望、规划产品路线 |
| 时春杰 | 软件 | 技术可行性评估、固件开发 |

**案例 - 研发部处理功能期望**：
> 1. 查看功能期望列表，按投票数排序
> 2. "快速启动" - 23个客户请求，AI建议高优先级
> 3. 评估技术可行性，添加评估意见
> 4. 纳入固件8025规划
> 5. 开发完成，发布新固件
> 6. 系统自动推送给相关客户："您期望的快速启动功能已发布"

**管理层 - 服务监督**

| 人员 | 职责 | 服务场景 |
|-----|------|---------|
| Jihua | CEO | 查看周报/月报、处理重大异常 |
| Sherry | 财务 | 结算审核、欠款管理 |

> 注：Cathy为市场部负责人，见上方市场部角色

**案例 - 管理层处理紧急问题**：
> 1. 收到P1紧急工单推送 (App)
> 2. 某批次产品出现批量死机问题
> 3. 立即协调研发部分析原因
> 4. 决策：召回该批次 or 发布紧急固件修复
> 5. 跟踪处理进度，确保闭环

### 1.5 完整服务案例

#### 案例1：从咨询到返修到知识沉淀

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 1: 客户联系                                                          │
│   客户Max联系经销商ProAV："我的Edge 8K拍摄4K 50fps时会死机"              │
│   ProAV创建咨询工单 K2602-0001                                           │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 1-2: 问题排查                                                        │
│   ProAV查询知识库，引导Max排查：                                         │
│   - 检查固件版本 → 已是最新8023                                          │
│   - 检查工作温度 → 正常范围                                              │
│   - 尝试恢复出厂设置 → 问题依旧                                          │
│   排查无效，确认需要返修                                                  │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 2: 升级为RMA返厂单                                                   │
│   咨询工单 K2602-0001 → 升级为RMA返厂单 RMA-D-2602-0001                  │
│   系统AI预估：SDI模块故障(65%) / 主板问题(25%)                           │
│   预估费用：$98 - $314                                                   │
│   客户确认预估价格，寄出设备                                              │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 5: 生产部收货检测                                                    │
│   生产部收到设备，开始检测                                                │
│   发现：主板有轻微腐蚀，可能是潮湿环境导致                                │
│   实际维修方案：更换主板 + 清洁                                          │
│   实际费用：$799 (超预估，触发异常流程)                                   │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 5-6: 异常确认                                                        │
│   市场部通知客户实际情况和费用变更                                        │
│   客户确认继续维修                                                        │
│   生产部继续维修                                                          │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 8: 维修完成                                                          │
│   维修完成，填写维修报告                                                  │
│   AI建议：此案例可沉淀为知识点 "潮湿环境导致主板腐蚀"                    │
│   市场部确认，发布到知识库                                                │
│   设备寄回客户                                                            │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ Day 12: 服务闭环                                                         │
│   客户收到设备，确认问题解决                                              │
│   RMA返厂单 RMA-D-2602-0001 关闭                                         │
│   咨询工单 K2602-0001 完成，记录处理时长和结果                            │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 案例2：从功能期望到产品发布到客户推送

```
┌─────────────────────────────────────────────────────────────────────────┐
│ 收集阶段 (多次服务中积累)                                                 │
│   咨询工单 K2502-0089: 客户A说"希望支持快速启动"                          │
│   咨询工单 K2502-0156: 客户B说"开机太慢了，能不能加快？"                   │
│   咨询工单 K2602-0012: 客户C说"快速启动对拍摄很重要"                       │
│   ...共23个客户提出类似需求                                               │
│   AI自动识别并合并为功能期望 FR-2502-0089                                │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ 评估阶段                                                                  │
│   研发部查看功能期望池                                                    │
│   FR-2025-0089 "快速启动" - 投票数23，AI建议高优先级                     │
│   技术评估：可行，需要2周开发                                             │
│   决策：纳入固件8025规划                                                  │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ 开发阶段                                                                  │
│   研发部开发快速启动功能                                                  │
│   测试验证                                                                │
│   准备发布                                                                │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ 发布阶段                                                                  │
│   固件8025发布                                                            │
│   系统自动匹配：FR-2025-0089 的target_version = 8025                     │
│   状态更新：已规划 → 已发布                                               │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│ 推送闭环                                                                  │
│   系统查找关联的23个客户                                                  │
│   批量推送邮件 + App通知：                                                │
│   "您期望的快速启动功能已在固件8025中发布！"                              │
│   客户收到推送，感受到被重视 → 忠诚度提升                                 │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.6 业务现状理解

> 参考: A02-产品返修记录.xlsx

**当前问题管理流程**:
```
客户/经销商反馈问题
        ↓
市场部记录（问题描述 + 解决方案）
        ↓
生产部处理（维修内容 + 问题分析）
        ↓
闭环（返回客户 / 知识沉淀）
```

### 1.7 服务类型与记录分类

#### 1.7.1 服务类型

| 服务类型 | 说明 | 产出 |
|---------|------|------|
| **咨询服务** | 功能使用、参数设置、兼容性问题 | 咨询工单（关闭） |
| **问题排查** | 故障诊断、远程协助、Troubleshooting | 咨询工单（关闭/升级） |
| **本地维修** | 经销商本地完成维修（不寄回总部） | 经销商维修单 |
| **返修服务** | 设备需寄回深圳总部维修 | RMA返厂单 |
| **功能期望** | 产品改进建议、新功能需求 | 功能期望记录 |

#### 1.7.2 咨询工单生命周期管理

#### 状态流转图

```
┌──────────────────────────────────────────────────────────────────────────┐
│                         咨询工单生命周期                                   │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│    ┌────────┐     ┌────────┐     ┌──────────────┐                       │
│    │  创建   │────►│ 处理中  │────►│ 待客户反馈   │                       │
│    └────────┘     └────────┘     └──────┬───────┘                       │
│                         ▲               │                                │
│                         │               │ 客户回复                        │
│                         └───────────────┘                                │
│                                         │                                │
│            ┌────────────────────────────┼────────────────┐               │
│            │                            │                │               │
│            ▼                            ▼                ▼               │
│    ┌──────────────┐           ┌──────────────┐   ┌──────────────┐       │
│    │   已解决      │           │  自动关闭     │   │   转工单      │       │
│    │ (客户确认)    │           │ (7天无反馈)   │   │(需要维修)     │       │
│    └──────────────┘           └──────────────┘   └──────────────┘       │
│                                      │                   │               │
│                                      │                   ▼               │
│                               可重新打开          ┌──────────────┐       │
│                            (30天内同问题)         │  经销商维修单 │       │
│                                                  │   或         │       │
│                                                  │  RMA返厂单    │       │
│                                                  └──────────────┘       │
└──────────────────────────────────────────────────────────────────────────┘
```

#### 状态定义

| 状态 | 说明 | 触发条件 |
|-----|------|---------|
| **处理中** | 正在处理客户问题 | 创建咨询工单时 |
| **待客户反馈** | 已回复客户，等待确认 | 工作人员回复后 |
| **已解决** | 问题已解决 | 客户确认解决 |
| **自动关闭** | 无响应自动关闭 | 待反馈状态超过7天 |
| **转工单** | 升级为维修工单 | 确认需要维修时 |

#### 自动关闭规则

| 触发时间 | 系统行为 |
|---------|---------|
| 待反馈第5天 | 发送提醒："您的服务请求即将关闭，如仍有问题请回复" |
| 待反馈第7天 | 状态自动变为"自动关闭" |

#### 重新打开规则

| 条件 | 处理方式 |
|-----|---------|
| 关闭后30天内 + 同一客户 + 同一产品 + 同一问题 | 重新打开原咨询工单，状态变为"处理中" |
| 超过30天 或 不同问题 | 创建新咨询工单，关联历史记录 |

#### 时间指标（系统自动计算）

| 指标 | 定义 | 用途 |
|-----|------|------|
| **首次响应时长** | 创建 → 首次回复 | SLA考核指标 |
| **总服务时长** | 创建 → 关闭 | 整体服务效率 |
| **有效处理时长** | 总时长 - 待客户反馈时长 | 实际工作量衡量 |

#### 1.7.3 工单类型区分（本地维修 vs 返厂维修）

> **核心概念澄清**：经销商自行维修使用SVC单，设备寄回总部使用RMA单。

```
维修需求判断
├── 经销商可自行处理？
│   ├── 是 → 创建【经销商维修单 SVC】→ 经销商本地维修 → 配件消耗记录
│   └── 否 → 需要寄回Kinefinity？
│           ├── 是 → 创建【RMA返厂单】→ 物流 → 总部维修
│           └── 否 → 继续排查 或 关闭咨询工单
```

#### 工单类型对比

| 特征 | 经销商维修单 (SVC) | RMA返厂单 |
|-----|------------------------|----------------------|
| **适用场景** | 经销商有能力本地维修 | 需要寄回深圳总部维修 |
| **适用级别** | 一级、二级经销商 | 所有级别经销商 |
| **设备去向** | 留在经销商本地 | 寄回Kinefinity总部 |
| **工单号** | SVC-D-YYMM-XXXX | RMA-{C}-YYMM-XXXX |
| **维修执行** | 经销商自行完成 | 生产部执行 |
| **配件来源** | 库存配件或临时发货 | 总部库存 |
| **结算方式** | 一级:定期结算；二级:单次PI | 单次PI或定期结算 |
| **编号示例** | SVC-D-2602-0001 | RMA-D-2602-0001 |

#### 典型场景示例

**场景A：一级经销商本地维修（经销商维修单 SVC）**
```
ProAV客户Edge 8K死机
    ↓
ProAV创建咨询工单 K2602-0001，排查后确认需更换SDI模块
    ↓
ProAV判断：可使用库存配件本地维修
    ↓
创建【经销商维修单】SVC-D-2602-0001
    ↓
ProAV自行维修，记录使用配件
    ↓
系统自动扣减库存，记入月度结算
    ↓
经销商维修单关闭，咨询工单完成
```

**场景B：三级经销商申请返修（RMA返厂单）**
```
RMK客户Terra 4K故障
    ↓
RMK创建咨询工单 K2602-0015，无法本地处理
    ↓
创建【RMA返厂单】RMA-D-2602-0008
    ↓
客户寄回深圳总部
    ↓
生产部维修完成
    ↓
寄回客户，RMA返厂单关闭
```

#### 经销商维修能力边界

| 可本地维修（经销商维修单） | 必须寄回总部（RMA返厂单） |
|---------------------|---------------------|
| 更换Back板/SDI口/HDA板 | MC板更换（需刷程序） |
| 更换Video口/风扇/按键板 | 问题不明确的复杂故障 |
| 更换卡农口模块/USB-C模块 | 清灰（需洁净环境） |
| 更换TF卡/RS口板 | 老机器无明确维修说明 |
| | 三级经销商的所有维修需求 |

#### 1.7.4 客户上下文支持

当处理咨询工单或RMA工单时，系统自动显示客户上下文信息，帮助快速了解客户背景。

#### 双维度查询能力

> **业务场景**：产品可能被转让或出租，当前使用者 ≠ 原购买客户。
> 系统支持按**客户**或**产品SN号**两种维度查询上下文。

| 查询维度 | 触发方式 | 显示内容 | 适用场景 |
|---------|---------|---------|---------|
| **按客户** | 输入客户姓名/联系方式 | 该客户所有设备、服务历史、AI画像 | 了解客户整体情况 |
| **按产品SN** | 输入/扫码产品序列号 | 该设备所有服务历史（可能涉及多个用户） | 设备转让/出租后追溯维修历史 |

**示例场景**：
```
客户A购买 Edge 8K (SN: ME_207890)
    ↓
客户A将设备转让给客户B
    ↓
客户B联系经销商咨询问题
    ↓
经销商输入SN: ME_207890
    ↓
系统显示该设备的完整服务历史：
• SR-2025-0089: 客户A的咨询记录
• IS-2025-0156: 客户A的维修记录
• (当前) 客户B的新咨询
```

#### 上下文信息组成

```
┌─────────────────────────────────────────────────────────────────┐
│ 上下文面板（支持按客户/按SN切换查询）                              │
├─────────────────────────────────────────────────────────────────┤
│ [按客户查询] [按SN查询]  ← 切换标签                              │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 设备信息 (按SN查询时显示)                                    │ │
│ │ ┌─────────────────┬─────────────────┬──────────────────────┐│ │
│ │ │ MAVO Edge 8K    │ ME_207890       │ 在保至 2027-03-15    ││ │
│ │ │ 原购买客户: Max │ 当前用户: John  │ (已转让)             ││ │
│ │ └─────────────────┴─────────────────┴──────────────────────┘│ │
│ └─────────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 设备列表 (按客户查询时显示)                                  │ │
│ │ ┌─────────────────┬─────────────────┬──────────────────────┐│ │
│ │ │ MAVO Edge 8K    │ ME_207890       │ 在保至 2027-03-15    ││ │
│ │ │ Eagle HDMI      │ EH_104523       │ 已过保               ││ │
│ │ └─────────────────┴─────────────────┴──────────────────────┘│ │
│ └─────────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 服务历史 (近3个月)                                           │ │
│ │ • K2602-0089: 高帧率设置咨询 → 已解决 (1/15) [客户A]         │ │
│ │ • RMA-C-2602-0012: SDI模块更换 → 已完成 (1/8) [客户A]        │ │
│ │ • K2512-0847: 死机问题排查 → 已解决 (12/20) [客户A]          │ │
│ └─────────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ AI客户画像 (按客户查询时显示)                                │ │
│ │ 标签: 高频用户 | 技术能力强 | 偏好邮件沟通 | VIP客户         │ │
│ │ 提示: 此客户曾提出过2个功能期望，均已纳入规划                │ │
│ └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 上下文显示规则

| 角色 | 可见范围 |
|-----|---------|
| 市场部 | 全部客户的完整上下文 |
| 经销商 | 仅自己客户的上下文（服务历史仅显示本经销商创建的记录） |
| 生产部 | 当前工单关联客户的设备列表和服务历史 |

#### AI客户画像生成规则

| 标签类型 | 生成逻辑 |
|---------|---------|
| 活跃度 | 近6个月咨询工单数：>5高频，2-5中频，<2低频 |
| 技术能力 | 问题描述质量、是否能自行排查 |
| 沟通偏好 | 历史沟通渠道统计 |
| 客户等级 | 来自客户档案设置 |
| 特殊提示 | 历史异常情况、功能期望、重要信息 |

#### 1.7.5 客户账户模型（Account / Customer Model）

系统将所有对外主体（终端客户、机构大客户、经销商、内部/合作伙伴）统一建模为「客户账户」，并通过结构化字段区分身份、购买渠道和服务等级，用于支持服务视图隔离和统计分析。

##### 1.7.5.1 账户类型 account_type

用于描述账户在业务上的本质身份。

| 枚举值 | 含义 | 示例 |
|--------|------|------|
| DEALER | 经销商/渠道伙伴 | ProAV、Gafpa、1SV、EU Office 等 |
| END_USER | 终端用户（个人或公司） | 自行购买设备的个人导演、摄影师 |
| CORPORATE | 机构/大客户 | 租赁公司、制作公司、教育机构、广电机构 |
| INTERNAL | 内部/合作伙伴 | 内部样机使用部门、内部测试账号、特殊合作伙伴 |

> 说明：原文档中的「终端客户」「KOL/媒体」「经销商」「内部样机」等角色，均映射到上述 account_type 枚举中。

##### 1.7.5.2 获客渠道 acquisition_channel

用于描述该账户名下设备的主要购买来源，用于服务归属和业务统计。

| 枚举值 | 含义 |
|--------|------|
| DIRECT | 官方直销（官网、直营店、官方旗舰店等） |
| CHANNEL | 渠道购买（通过某个经销商购买） |

- acquisition_channel 是客户/账户的**长期属性**，表示客户最初是通过官方还是经销商获得设备。
- RMA 中的 channel_code（D/C/I）表示的是**本次工单的发起渠道**，两者互补但含义不同。

##### 1.7.5.3 关联经销商 parent_dealer_id

当 acquisition_channel = CHANNEL 时，系统需要记录该客户的销售归属经销商：

- parent_dealer_id 为必填，指向一个 account_type = DEALER 的账户记录。
- 语义：该客户/设备是由哪一家经销商销售出去的，用于「名下客户」定义和业绩统计。
- 工单中的 dealer_id 表示**本次服务的服务经销商**（谁在处理这次服务），通常等于 parent_dealer_id，但在特殊情况下允许不同（如区域经销商交叉支援）。

> 名下客户定义：
>
> - 对于经销商用户，「名下客户」指满足 account_type ∈ {END_USER, CORPORATE} 且 parent_dealer_id = 当前经销商.id 的客户集合。
> - 经销商只能查看自己名下客户的信息、设备和关联工单，无法访问其他经销商的客户数据。

##### 1.7.5.4 服务等级 service_tier

用于整合原「VIP/一般客户」概念，作为统一的服务等级字段，支撑响应优先级和审批策略。

| 枚举值 | 含义 | 示例策略 |
|--------|------|----------|
| STANDARD | 标准服务 | 默认响应优先级 P3 |
| VIP | 重要客户 | 默认响应优先级 P2 |
| VVIP | 核心大客户/重点项目 | 默认响应优先级 P1，部分操作可简化审批 |
| BLACKLIST | 黑名单/高风险客户 | 部分操作需额外审批，如先收款后维修 |

- 服务等级由市场部在客户档案中维护，可随业务发展调整。
- 服务等级与 PRD 中的服务响应优先级 P1/P2/P3 结合，用于生成 AI 建议的默认优先级（例如 VVIP + 严重问题 → 建议 P1）。

##### 1.7.5.5 行业标签 industry_tag

用于对客户进行行业画像，可多选，用于市场分析和 AI 画像。

- 示例标签（可按字典维护，可扩展）：
  - Freelancer：个人创作者/自由职业者
  - Rental_House：租赁公司
  - Production：制片公司/制作公司
  - Education：教育机构
  - Broadcast：广电机构
  - Other：其它行业（或自定义标签）

- 行业标签既可在客户建档时录入，也可在后续服务过程中补充或修订。
- AI 客户画像会综合行业标签、历史工单、功能期望等信息，生成更精细的服务建议。

#### 1.7.6 经销商咨询工单模式

经销商处理客户问题时，可选择两种模式：

#### 模式对比

| 模式 | 快速查询模式 | 代客户服务模式 |
|-----|------------|---------------|
| **场景** | 客户简单咨询，查知识库即可 | 需要记录跟踪的服务 |
| **是否创建记录** | 否 | 是（创建咨询工单） |
| **客户信息** | 不需要 | 可选填（姓名、联系方式） |
| **知识库访问** | 可用 | 可用 |
| **统计计入** | 不计入 | 计入服务统计 |

#### 代客户服务模式 - 客户信息字段

| 字段 | 是否必填 | 说明 |
|-----|---------|------|
| 客户姓名 | 可选 | 如不填写，显示"匿名客户" |
| 联系方式 | 可选 | 电话/邮箱/微信 |
| 产品型号 | 建议填写 | 便于问题分析 |
| 序列号 | 可选 | 如填写可关联设备档案 |

> **设计原则**：降低经销商创建咨询工单的门槛，鼓励记录客户问题，便于后续分析和服务改进。

#### 1.7.7 RMA返厂单类型（按来源）

| 类型 | 说明 | 示例 |
|-----|------|------|
| **客户返修** | 终端客户使用中出现的问题 | 客户Max的Edge 8K死机 |
| **生产问题** | 出厂质量问题、发货错误 | 新机开箱发现划痕 |
| **内部样机** | 测试机、展示机、租赁机返修 | 展会样机故障 |

> **产品线**（Edge/MM2/Terra/EAGLE等）是RMA返厂单的属性，不作为分类依据。

#### 1.7.8 问题严重程度 (Severity)

用于评估问题的技术影响程度，辅助优先级判断：

| 等级 | 定义 | 示例 |
|-----|------|------|
| 1级 | 严重错误 + 严重后果 | 导致退换货、恶劣影响、丢失销售订单 |
| 2级 | 严重错误 + 无严重后果 | 首次出现的1级问题降为2级 |
| 3级 | 一般问题 | 首次出现的问题、轻微问题 |

### 1.8 服务响应与处理时效

#### 1.8.1 服务响应优先级 (P1/P2/P3)

**定义**：内部人员对客户/经销商反馈的**首次响应时限**。

**适用范围**：咨询工单、RMA返厂单的初始响应。

| 优先级 | 标签 | 响应时限 | 适用场景 | 响应方式 |
|-------|------|---------|---------|---------|
| P1 | 紧急 | 8小时内 | 新机开箱故障、批量质量问题、影响重要拍摄、客户强烈投诉 | 电话+系统 |
| P2 | 高 | 24小时内 | VIP客户、核心功能不可用、经销商催办 | 系统回复 |
| P3 | 标准 | 48小时内 | 普通客户、常规问题、咨询类 | 系统回复 |

**使用场景**：
- 市场部收到新咨询工单 → 根据优先级安排响应顺序
- 超时未响应 → 系统自动提醒/升级

#### 1.8.2 返修处理优先级 (R1/R2/R3)

**定义**：生产部完成维修的**目标时限**（从收到设备到维修完成）。

**适用范围**：RMA返厂单的维修环节。

| 优先级 | 标签 | 完成时限 | 适用场景 |
|-------|------|---------|---------|
| R1 | 加急 | 1个工作日 | 新机换新、重要客户、紧急项目需求 |
| R2 | 优先 | 3个工作日 | VIP客户、批量问题、经销商催办 |
| R3 | 标准 | 7个工作日 | 常规返修、一般维修 |

**优先级自动建议规则**：
- 新机故障（购买<30天）→ 服务P1 + 返修R1
- 严重程度1级 → 服务P1
- 经销商创建 → 默认服务P2、返修R3
- 其他 → 默认服务P3、返修R3

### 1.9 用户角色与权限分层

| 层级 | 角色 | 说明 | 数据访问范围 |
|-----|------|------|-------------|
| **外部** | 终端客户 | 购买产品的最终用户 | 仅自己的工单、Public知识库 |
| **外部** | KOL/媒体 | 测评人员 | 同客户 |
| **合作伙伴** | 一级经销商 | 有配件库存+维修能力，区域分销商 | 自己客户的工单、Dealer知识库、配件库存管理 |
| **合作伙伴** | 二级经销商 | 有维修能力但无备件 | 自己客户的工单、Dealer知识库 |
| **合作伙伴** | 三级经销商 | 无维修能力无备件 | 自己客户的工单、Dealer知识库 |
| **内部** | 市场部 | 国内(李雨健)、国外(Effy) | 全部工单、全部知识库 |
| **内部** | 生产部 | 黄碧珊(负责人)、陈高松、张工、张平娇等 | 全部工单(维修视角)、内部知识库 |
| **内部** | 研发部 | 吴琪萌(产品)、时春杰(软件) | 全部工单(分析视角)、内部知识库 |
| **内部** | 管理层 | Jihua | 全部数据 + 统计报表 |

#### 1.9.1 角色与账户类型映射

| 角色范围 | 示例人物/组织 | 对应 account_type | 说明 |
|----------|----------------|-------------------|------|
| 终端客户 / KOL / 媒体 | 购买产品的最终用户、测评人员 | END_USER | 通过官网或经销商购买设备的最终使用者 |
| 机构大客户 | 租赁公司、制作公司、教育机构、广电等 | CORPORATE | 非经销商但享有特殊服务策略的大客户 |
| 经销商（一级/二级/三级） | ProAV、Gafpa、1SV、EU Office、DP Gadget、RMK 等 | DEALER | 负责区域销售和一部分售后服务的渠道伙伴 |
| 内部团队 / 合作伙伴 | 市场部、生产部、研发部、内部样机使用部门等 | INTERNAL | 内部使用或特殊合作账号，用于区分内部样机、生产问题等 |

> 说明：
> - 角色表用于描述「人/组织在业务流程中的职责」，account_type 用于数据和权限层面的分类，两者一一对应但维度不同。
> - 同一组织在不同系统中可以拥有多个登录账号（如内部账号 + 经销商账号），由 account_type 区分在服务系统中的身份。

**经销商分级详情**:

| 分级 | 经销商 | 地区 | 配件库存 | 维修能力 | 结算方式 | 使用端 |
|-----|-------|------|---------|---------|---------|-------|
| **一级** | ProAV | 英国/部分欧洲 | 有 | 强 | 定期结算 | Web |
| **一级** | Gafpa | 大部分欧洲 | 有 | 强 | 定期结算 | Web |
| **一级** | 1SV | 美国 | 有 | 强 | 定期结算 | Web |
| **一级** | EU Office | 欧洲(补充) | 有 | 强 | 定期结算 | Web |
| **二级** | DP Gadget | 东南亚 | 无 | 有 | 单次开PI | Web |
| **三级** | RMK | 澳洲 | 无 | 无 | 单次开PI | Web |

> 注：经销商暂时仅支持Web端，未来版本考虑iOS端

**一级经销商特点**:
- 区域分销商，销售能力强
- 有配件库存，定期补货
- 可处理大部分不涉及刷程序、清灰的维修
- 复杂问题需寄回总部

**二级经销商特点**:
- 有维修能力但无备件库存
- 需临时发货配件后自行维修
- 复杂问题需寄回总部

**三级经销商特点**:
- 无维修能力、无备件库存
- 所有问题均需寄回总部维修

**经销商可自行处理的维修类型** (一级/二级):
- 更换前部/Back/SDI口/RS口板/TF卡
- 更换HDA板、Video口、风扇、按键板
- 更换卡农口模块、USB-C/3.5mm模块

**必须寄回深圳处理的情况**:
- MC板更换（需要刷程序）
- 问题不明确的复杂故障
- 清灰（需要洁净环境）
- 老机器无明确维修说明
- 三级经销商的所有维修需求

### 1.10 核心价值
1. **全流程闭环**: 问题录入 → 跟踪处理 → 统计分析 → 知识沉淀
2. **多维度洞察**: 支持任意维度交叉分析，发现问题模式
3. **知识复用**: 将解决方案沉淀为知识库，提升响应效率
4. **AI赋能**: 智能问答、工单分析、趋势预警

---

## 2. 返修管理体系

> **重要区分**：返修涉及多种场景，需要区分处理流程和结算方式。

### 2.0 返修场景分类

```
返修场景
├── A. 客户返修（寄回总部）
│   ├── A1. 国内客户直接寄修
│   └── A2. 海外客户通过经销商寄修
│
├── B. 经销商本地维修（不寄回总部）
│   ├── B1. 一级经销商：使用库存配件维修
│   └── B2. 二级经销商：申请配件后维修
│
└── C. 生产问题/内部样机
    └── 内部流程，不涉及客户收费
```

**场景与收费对照**：

| 场景 | 维修地点 | 配件来源 | 收费对象 | 结算方式 |
|-----|---------|---------|---------|---------|
| A1 国内客户寄修 | 深圳总部 | 总部库存 | 客户（过保） | 单次PI |
| A2 海外客户寄修 | 深圳总部 | 总部库存 | 客户（过保） | 单次PI |
| B1 一级经销商本地维修 | 经销商 | 经销商库存 | 客户（过保） | 月度/季度结算 |
| B2 二级经销商本地维修 | 经销商 | 临时发货 | 客户（过保） | 单次PI |
| C 生产问题/样机 | 深圳总部 | 总部库存 | 内部（无） | 不收费 |

### 2.1 三层工单编号规则

> 本节详细说明三层工单模型的编号体系，与1.7节定义保持一致。

**工单类型与编号格式**：

| 工单类型 | 编号格式 | 示例 | 说明 |
|---------|---------|------|------|
| **咨询工单** | KYYMM-XXXX | K2602-0001 | 咨询、问题排查等服务的统一入口 |
| **RMA返厂单** | RMA-{C}-YYMM-XXXX | RMA-D-2602-0015 | 设备返回Kinefinity总部维修，每台设备独立RMA号 |
| **经销商维修单** | SVC-D-YYMM-XXXX | SVC-D-2602-0001 | 经销商本地维修，不寄回总部 |

**编号规则详解**：

1. **YYMM（年月）**：
   - YY：年份后两位（如 26 = 2026年）
   - MM：月份两位数（如 02 = 2月）
   - 示例：2602 = 2026年2月

2. **XXXX（流水号）**：
   - 0001-9999：十进制流水号
   - A000-FFFF：超过9999后自动转16进制
   - 每月序号重置，月度容量：65535条

3. **RMA渠道代码 {C}**：
   - **D** = Dealer（经销商渠道）
   - **C** = Customer（直客渠道）
   - 示例：
     - RMA-D-2602-0001：经销商提交的第1个RMA
     - RMA-C-2602-0001：直客提交的第1个RMA

**编号生成规则**：
- 每种工单类型的流水号独立计数
- 流水号按创建时间顺序递增，不可回退
- RMA返厂单的D/C通道共享同一流水号池（按提交先后统一编号）
- 系统自动生成，人工不可修改

### 2.2 维修配件SKU体系

> 数据来源: `input docs/维修配件SKU&价格单.xlsx`

**SKU格式**: `S` + `物料ID`（部分老型号配件无SKU编码）

**价格支持**: CNY / USD / EUR 三种货币

**配件分类概览** (共74个配件):

| 分类 | 配件数量 | 价格区间(USD) |
|-----|---------|--------------|
| EAGLE EVF | 3 | $68 - $586 |
| MAVO Edge/mark2 | 29 | $19 - $2499 |
| TERRA/MAVO S35/LF | 14 | $39 - $1599 |
| 监看 | 9 | $69 - $299 |
| 转接卡口 | 8 | $49 - $399 |
| KineBACK | 3 | $109起 |
| KineMAG Nano | 1 | $79 |
| UPS底座 | 1 | - |
| 供电 | 4 | - |
| 线缆 | 2 | - |

#### 完整配件SKU清单

<details>
<summary>EAGLE EVF (3个配件)</summary>

| SKU | 配件名称 | CNY | USD | EUR |
|-----|---------|-----|-----|-----|
| S2-119-012-01 | EAGLE 主板 | ¥982 | $187 | €187 |
| S2-119-011-01 | EAGLE 按键板 | ¥276 | $68 | €68 |
| S2-119-003-01 | EAGLE 目镜 | ¥3982 | $586 | €586 |

</details>

<details>
<summary>MAVO Edge/mark2 (29个配件)</summary>

| SKU | 配件名称 | CNY | USD | EUR |
|-----|---------|-----|-----|-----|
| S1-019-003-01 | Edge 8K Sensor | ¥15000 | $2499 | €2499 |
| S1-019-004-01 | Edge 6K Sensor | ¥9500 | $1599 | €1599 |
| S1-019-005-01 | MM2 S35 传感器 | - | - | - |
| S3-800-002-01 | Edge主板 | ¥4000 | $799 | €799 |
| S1-010-001-01 | Edge/MM2 MC(图像处理模块) | ¥5500 | $1199 | €1199 |
| S1-010-010-02 | Edge显示模块 | ¥990 | $199 | €199 |
| S1-010-006-01 | Edge电源模块(Back板) | ¥990 | $299 | €299 |
| S1-010-007-01 | MM2电源模块(Back板) | ¥990 | $299 | €299 |
| S1-019-008-01 | Edge DK板(主板接口模块) | ¥990 | $249 | €249 |
| S1-016-501-02 | Edge ND模块 | ¥4000 | $750 | €750 |
| S4-000-004-01 | Edge ND电机 | - | $59 | €59 |
| S1-019-010-01 | Edge FRONT模块(电机/卡口识别) | - | $69 | €69 |
| S1-019-017-01 | Edge/MM2 侧屏 | ¥590 | $120 | €120 |
| S1-011-001-01 | Edge Video口（上） | ¥290 | $59 | €59 |
| S1-011-002-01 | Edge Video口（下） | ¥290 | $59 | €59 |
| S1-010-012-01 | Edge按键板 | ¥690 | $95 | €95 |
| S1-010-013-01 | MM2按键板 | ¥690 | $95 | €95 |
| S1-019-013-02 | USB接口小板 | ¥690 | $95 | €95 |
| S4-000-003-01 | 风扇 | ¥120 | $65 | €65 |
| S1-011-013-01 | SDI模块 | ¥390 | $69 | €69 |
| S1-011-014-01 | Edge RS模块(八爪鱼) | ¥290 | $59 | €59 |
| S1-011-015-01 | MM2 RS模块(八爪鱼) | ¥290 | $59 | €59 |
| S1-010-010-01 | Edge UPS小板 | ¥590 | $95 | €95 |
| S4-000-005-01 | Edge/MM2 系统存储卡 | ¥98 | $19 | €19 |
| S1-016-305-01 | Edge/MM2 卡侬口模块 | - | $95 | €95 |
| B-011-001-02 | Edge 8K 前部 | - | - | - |
| B-011-002-01 | Edge 6K 前部 | - | - | - |
| B-019-001-01 | Edge/MM2 Lens口（5芯双键） | - | - | - |
| S1-015-402-02 | Edge/MM2 卡侬口盖子 | - | - | - |

</details>

<details>
<summary>TERRA/MAVO S35/LF (14个配件) - 无SKU编码</summary>

| 配件名称 | CNY | USD | EUR | 备注 |
|---------|-----|-----|-----|------|
| Sensor/传感器 | ¥3500-9500 | $599-1599 | €599-1599 | 按型号：LF/MAVO/T4/T6 |
| 主板 | ¥3000 | $499 | €499 | |
| 显示模块(MA) | ¥790 | $199 | €199 | |
| 图像处理模块(MC) | ¥3000 | $499 | €499 | |
| PCIe通信模块(Relay板) | ¥490 | $99 | €99 | |
| 电源管理模块(SATA板) | ¥790 | $139 | €139 | |
| HDMI板 | ¥99 | $39 | €39 | |
| SDI板 | ¥550 | $149 | €149 | |
| 侧屏 | ¥299 | $95 | €95 | |
| 按键板 | ¥490 | $99 | €99 | |
| 内存条 | ¥590 | $120 | €120 | |
| SSD舱门 | ¥390 | $69 | €69 | |
| 风扇/3.5mm接口 | ¥190 | - | - | |

</details>

<details>
<summary>监看 (9个配件) - 无SKU编码</summary>

| 配件名称 | CNY | USD | EUR |
|---------|-----|-----|-----|
| KineMON Video口 | ¥290 | $95 | €95 |
| KineMON主板 | ¥990 | $199 | €199 |
| 5U2屏幕模块 | ¥1290 | $250 | €250 |
| 7U2屏幕模块 | - | $250 | €250 |
| KineMON 5U2 PCB | ¥990 | $199 | €199 |
| 7U2铝框 | ¥350 | $69 | €69 |
| FPC线和插座 | ¥350 | $69 | €69 |
| EVF主板 | ¥2000 | $299 | €299 |
| EVF镜组 | - | - | - |

</details>

<details>
<summary>转接卡口 (8个配件) - 无SKU编码</summary>

| 配件名称 | CNY | USD | EUR |
|---------|-----|-----|-----|
| 卡口前口触点 | ¥190 | $59 | €59 |
| 卡口主板 | ¥190 | $49 | €49 |
| 法兰面 | ¥99 | $49 | €49 |
| EFEN转接卡口前部 | ¥999 | $199 | €199 |
| PL卡口前部 | ¥500 | $149 | €149 |
| EFEN增光减焦玻璃 | ¥990 | $199 | €199 |
| 卡口ND镜片 | ¥2000 | $399 | €399 |
| EFEN锁紧环 | ¥550 | $109 | €109 |

</details>

<details>
<summary>其他配件 (KineBACK/KineMAG/UPS/供电/线缆)</summary>

**KineBACK**:
| 配件名称 | CNY | USD |
|---------|-----|-----|
| SDI模块 | ¥550 | $109 |
| V口结构件 | ¥99 | - |
| V口金针 | ¥190 | - |

**KineMAG Nano**:
| 配件名称 | CNY | USD |
|---------|-----|-----|
| 存储卡主板(N卡主板) | ¥590 | $79 |

**UPS底座**:
| 配件名称 | CNY |
|---------|-----|
| UPS主板 | ¥190 |

**供电**:
| 配件名称 | CNY |
|---------|-----|
| PD混充主板 | ¥337 |
| PD混充外壳 | ¥112 |
| 2S/2Si电池（置换） | ¥99 |

</details>

### 2.3 产品族群与配件兼容规则

为避免产品生命周期和配件兼容关系被混用，服务系统在产品层面引入 4 个具有不同服务逻辑的族群，用于驱动工单创建、配件候选列表和维修报价规则。

**A 类：在售电影摄影机 (Current Cine Cameras)**
- 范围：当前主力销售和维护的电影摄影机，如 MAVO Edge 8K / MAVO Edge 6K / MAVO mark2 等。
- 服务特性：
  - 在工单创建和产品选择界面中默认优先展示。
  - 配件候选列表优先显示新一代专属配件（如 Edge/mark2 专用兔笼、KineMAG Nano 存储卡等）。

**B 类：存档/历史机型 (Archived Cine Cameras)**
- 范围：已停产但仍提供维修服务的机型，如 MAVO LF、MAVO S35、Terra 4K/6K 等。
- 服务特性：
  - 前端需折叠或明确标记为「历史机型」，避免干扰新用户选型，但仍支持创建工单和返修。
  - 仅关联老一代专属配件（如 KineMAG SSD (SATA)、老款手柄等），不暴露新一代专属配件。

**C 类：电子寻像器 (e-Viewfinder)**
- 范围：独立的电子取景系统，如 Eagle SDI / Eagle HDMI 等电子寻像器。
- 服务特性（关键）：
  - 创建与 C 类产品相关的咨询工单 / RMA 时，**必须填写「宿主设备信息 (Host Device)」**：
    - 宿主类型：Kinefinity 电影机 / 第三方相机；
    - 宿主机型：例如「MAVO Edge 6K」或「Canon C400」。
  - 流程分流：
    - 如宿主类型 = 第三方相机，则工单默认归类为「兼容性排查」场景，供研发/产品集中分析第三方兼容性问题；
    - 如宿主类型 = Kinefinity 电影机，则按常规硬件问题进入 RMA / 经销商维修流程。

**D 类：通用配件 (Universal Accessories)**
- 范围：严格限定为跨代通用、与具体机型兼容性弱相关的配件，例如：
  - GripBAT 系列电池等标准供电配件；
  - Magic Arm / Dark Tower 等安装类通用附件。
- 约束：
  - D 类配件在创建工单时可以不强制绑定具体机型，但系统仍鼓励填写实际关联机型以便后续分析。
  - **KineMON 系列监视器仅保证与 Kinefinity 电影摄影机配合使用，不属于 D 类通用配件**；在第三方机型场景下，系统需提示兼容性风险，不将其视作「通用显示器」。

**核心业务规则**

1. **存储卡隔离规则**
   - KineMAG Nano：仅当产品属于 A 类（Edge/mark2 系列）时，才作为配件候选出现；
   - KineMAG SSD (SATA)：仅当产品属于 B 类（MAVO LF/Terra 系列）时，才作为配件候选出现；
   - 目的：防止经销商/内部选错卡型导致备件发错，降低返工和物流成本。

2. **电子寻像器 + 宿主设备规则 (Eagle 兼容性)**
   - 当产品族群 = C 且宿主类型 = 第三方相机时：
     - 工单自动标记为「兼容性排查」，在统计报表和研发视图中可单独拉出；
     - 有利于识别「第三方兼容性问题」趋势，而不与常规硬件故障混在一起。
   - 当产品族群 = C 且宿主类型 = Kinefinity 电影机时：
     - 视为常规硬件/稳定性问题，走标准 RMA / 本地维修流程，无需特殊标记。

> 以上产品族群与配件规则，作为服务系统的**业务约束层**，为前端产品选择、配件候选过滤和报表统计提供统一依据，避免「在售/历史机型」「通用/专用配件」混用导致的误选和沟通成本。

### 2.4 Edge前部维修方案矩阵

> 适用于Edge 8K/6K前部更换维修，根据机型批次和是否更换ND选择方案

**机型批次说明**:
| 批次代码 | 机型 | 出货时间 | 前部类型 | 碳纤维类型 |
|---------|------|---------|---------|-----------|
| Edge 8K 1 | 8K 1-5系列 | 2021.3.31起 | 1.06圆脸前部(F1) | 圆脸碳纤维(C1) |
| Edge 8K 2 | 8K 6系列 | 2021.12.3起 | 1.06猫爪前部(F2) | 圆脸碳纤维(C1) |
| Edge 8K 3 | 8K 7系列711 | 2022.4.27起 | 1.86猫爪前部(F3) | 猫爪碳纤维(C2) |
| Edge 6K 1 | 6K早期 | 2022.1.10起 | 1.06 | - |
| Edge 6K 2 | 6K后期 | - | 1.86 | - |

**维修方案选择**:
| 方案 | 是否更换ND | 适用机型 | 说明 |
|-----|-----------|---------|------|
| **B1** | 不更换 | Edge 8K 1/2 | 仅更换前部框架 |
| **B2** | 不更换 | Edge 8K 2 | 简化方案 |
| **A1** | 更换 | Edge 8K 1/2 | 更换前部+ND模块 |
| **A2** | 更换 | Edge 8K 3, Edge 6K 2 | 1.86机型ND更换 |
| **A3** | 更换 | Edge 6K 1 | 6K早期型号ND更换 |

**方案价格表 (过保)**:
| 方案 | 国内(CNY) | 海外(USD) | 包含内容 |
|-----|----------|----------|---------|
| B1 | ¥1190 | $249 | 前部框架更换 |
| B2 | ¥799 | $199 | 简化前部更换 |
| A1 | ¥4190 | $849 | 前部+ND完整更换 |
| A2 | ¥2990 | $549 | 1.86前部+ND更换 |
| A3 | ¥3790 | $649 | 6K前部+ND更换 |

**特殊规则**:
- 在保维修：免费
- VIP客户：B2方案可申请免费
- 已购买电子E卡口客户：前部更换可享优惠
- 英国/欧洲/美国/加拿大：购买原生卡口可免费更换前部

### 2.5 运费管理

**区域默认运费表**:
| 区域 | 默认运费(USD) | 默认运费(EUR) | 说明 |
|-----|--------------|--------------|------|
| 英国 | $29 | €27 | ProAV |
| 欧洲大陆 | $35 | €32 | Gafpa, EU Office |
| 美国 | $45 | - | 1SV |
| 加拿大 | $50 | - | Cinetx |
| 东南亚 | $35 | - | DP Gadget |
| 澳洲 | $55 | - | RMK |
| 国内 | ¥30 | - | 国内客户 |

**运费规则**:
- PI生成时根据收货地区自动填充默认运费
- 工作人员可手动修改运费（如特殊快递、加急等）
- 在保维修：Kine承担运费
- 过保维修：客户/经销商承担运费

### 2.6 维修费用规则

**在保维修**:
- 配件费用: 免费
- 人工费用: 免费
- 返回运费: Kine承担

**过保维修**:
- 配件费用: 按SKU价格单收取
- 人工费用: 根据维修复杂度收取
- 运费: 客户承担（按区域默认，可调整）

**经销商结算**:
- 一级经销商: 预先发放配件库存，定期结算使用量
- 二级经销商: 临时开PI发货，单次结算

### 2.7 经销商配件库存管理

**核心原则**: 系统自动计算库存，无需经销商手动申报

**库存变动逻辑**:
```
初始库存 (总部发放) 
    ↓
经销商开维修工单 → 选择使用配件 → 系统自动扣减库存
    ↓
库存低于安全线 → 系统提醒补货
    ↓
总部发货 → 系统自动增加库存
```

**经销商维修工单流程**:
1. 经销商创建工单（记录客户问题）
2. 经销商自行维修，在工单中记录：
   - 维修内容（更换了什么模块）
   - 使用的配件（从库存中选择SKU）
   - 维修结果
3. 工单完成后，系统自动：
   - 扣减对应配件库存
   - 记录配件使用关联工单
   - 更新月度/季度结算报表

**库存预警机制**:
| 预警级别 | 条件 | 动作 |
|---------|------|------|
| 黄色 | 库存 ≤ 安全线 | 系统提醒经销商 |
| 红色 | 库存 = 0 | 通知市场部 + 经销商 |

**定期结算 (一级经销商)**:
- 系统按月/季度自动汇总配件使用量
- 生成结算PI（在保免费，过保按SKU计费）
- 发送给经销商确认付款

**市场部查询功能**:
- 实时查看各经销商配件库存
- 查看经销商已完成的维修工单
- 维修统计（按产品/问题类型/时间段）
- 配件使用趋势和补货预测

**异常处理**:
| 场景 | 处理方式 |
|-----|---------|
| 配件损耗/丢失 | 市场部手动调整库存，记录原因 |
| 维修后配件退回 | 工单中标记"未使用"，库存回退 |
| 问题配件回收 | 标记待寄回，批量寄回后核销 |

### 2.8 维俪PI（发票）

**PI内容**:
| 字段 | 说明 |
|-----|------|
| Invoice No | 发票编号 |
| Date | 日期 |
| Dealer RMA | 经销商RMA号 |
| Customer Info | 客户公司、联系人、邮箱 |
| Repair Info | 产品型号、序列号、保修状态 |
| Bill To | 账单地址 |
| Shipping | 收货地址 |
| 配件明细 | SKU、配件名称、数量、单价、小计 |
| Shipping Cost | 运费 |
| Total | 总计 |
| Description | 问题描述、原因分析、解决方案 |

### 2.9 返修报价预估机制

**核心原则**: 过保维修必须客户确认预估价格后才能寄修

**预估流程**:
```
问题反馈 → AI分析可能原因 → 生成预估价格范围 → 客户确认 → 寄修
```

**预估价格组成**:
| 组成 | 说明 | 定价依据 |
|-----|------|---------|
| 配件费用 | 可能需要更换的配件 | SKU价格表 |
| 人工费用 | 维修复杂度 | 按维修类型分档 |
| 运费 | 返回运费 | 区域默认运费表 |
| 检测费 | 如最终无法修复 | 暂定$0（后续可调整） |

**客户确认超时规则**:
| 天数 | 系统行为 |
|-----|---------|
| 7天 | 自动提醒客户/经销商 |
| 14天 | 工单标记"待跟进"，通知市场部 |
| 30天 | 工单自动关闭，标记"客户未响应" |

**客户反悔处理**:
- 确认后不寄修 → 原设备可退回客户
- 工单标记"客户取消"，不收取费用

**实际 vs 预估差异处理**:
| 差异情况 | 处理方式 |
|---------|---------|
| 实际 ≤ 预估 | 按实际收费 |
| 实际 > 预估 150% | 触发"维修异常处理"流程 |

### 2.10 补货与欠款关联机制

**核心原则**: 经销商申请补货时，必须检查历史PI结算状态

**欠款检查规则**:
| 欠款状态 | 账龄 | 系统行为 | 可否发货 |
|---------|------|---------|---------|
| 无欠款 | - | 正常审批流程 | ✅ 是 |
| 少量欠款 | <30天 | 警告提示 | ⚠️ 市场部决定 |
| 逾期欠款 | 30-60天 | 阻止+催款 | ❌ 需审批 |
| 严重逾期 | >60天 | 阻止+升级 | ❌ 需负责人审批 |

**紧急例外审批**:
- 紧急维修需求可由市场负责人(Cathy)审批例外
- 必须记录审批原因和审批人
- 同时触发催款流程

**信用额度机制**:
- **特殊经销商**: 仅部分特殊经销商具有credit账期（如一级大客户）
- **普通经销商**: 均要求付款后才发货，无信用额度
- 信用额度由管理层单独设置和调整

**扩展机制** (后续版本):
- 自动催款邮件
- 月度对账单

### 2.11 物流追踪机制

**快递单号状态类型**:
| 状态 | 说明 | 系统处理 |
|-----|------|---------|
| 已填写 | 正常物流追踪 | 查询物流API，预估到达 |
| 待补填 | RMA已生成，单号稍后填写 | 定期提醒(3天/7天) |
| 上门送达 | 直接送到深圳 | 记录预约时间 |
| Kine取件 | 公司安排取件 | 生成取件任务 |
| 集中发货 | 多个RMA合并一个包裹 | 关联多个工单 |

**预估收货时间**:
| 发货地 | 快递方式 | 预估天数 |
|-------|---------|---------|
| 英国 | DHL/UPS | 5-7天 |
| 欧洲大陆 | DHL | 5-8天 |
| 美国 | FedEx/UPS | 7-10天 |
| 东南亚 | DHL | 3-5天 |
| 澳洲 | DHL | 7-10天 |
| 国内 | 顺丰/京东 | 1-3天 |

**自动通知触发**:
- 快递单号填写 → 通知生产部、市场部
- 物流到达深圳 → 通知生产部准备收货
- 收货确认 → 通知经销商/客户

### 2.12 维修异常处理机制

**异常类型定义**:
| 异常类型 | 触发条件 |
|---------|---------|
| 成本超预估 | 实际费用 > 预估费用 × 150% |
| 严重损坏 | 设备进水/烧毁/严重摔坏 |
| 需换整机 | 维修成本 ≥ 整机价值60% |
| 人为损坏 | 非保修范围的人为问题 |
| 无法修复 | 关键部件损坏无法维修 |
| 发现其他问题 | 维修中发现额外问题 |

**处理流程**:
```
生产部发现异常 → 提交异常报告 → 暂停维修 → 
市场部与客户沟通 → 客户选择处理方式 → 继续/取消/换新/报废
```

**客户处理选项**:
| 选项 | 说明 | 费用 |
|-----|------|------|
| 确认继续维修 | 接受新报价 | 新报价金额 |
| 取消维修，原机退回 | 放弃维修 | $0（暂不收检测费） |
| 以旧换新 | 旧机折价换新机 | 新机价-折价 |
| 报废处理 | 设备无维修价值 | $0 |

**审批权限**:
| 异常金额 | 审批人 |
|---------|-------|
| 超预估 < $100 | 市场部业务员 |
| 超预估 $100-$500 | 市场部负责人 |
| 超预估 > $500 | 管理层 |

### 2.13 定期自动报告体系

**报告类型**:
| 报告名称 | 频率 | 收件人 | 内容 |
|---------|------|--------|------|
| 经销商库存周报 | 每周一 | 市场部负责人 | 各经销商库存、使用量、预警 |
| 经销商维修月报 | 每月1日 | 市场部、Cathy | 维修数量、问题分布、配件消耗 |
| 库存预警通知 | 实时 | 市场部 | 预警配件、建议补货量 |
| 欠款预警通知 | 每周/实时 | 市场部、财务 | 欠款金额、账龄、未结PI |
| 工单处理周报 | 每周一 | 部门负责人 | 新增/关闭工单、处理效率 |
| P1/R1紧急汇总 | 实时 | 管理层 | 紧急工单详情 |
| 产品质量月报 | 每月1日 | 研发、管理层 | 按产品问题分布、趋势 |

**推送方式**:
- 邮件: 富文本格式(HTML排版在邮件正文，不生成PDF附件)
- App通知: 摘要+跳转链接
- 系统站内信: 保留历史记录

### 1.5.5 经销商配件库存管理

**功能需求**:
- 查看当前配件库存数量
- 记录配件使用（关联工单）
- 配件补货申请
- 待寄回问题配件管理
- 库存使用报表（按月/季度）

---

## 3. 系统功能模块

> **设计理念**：按照用户的工作性质分模块，而非按角色分入口。

系统采用**三层架构**，清晰区分「作业」「知识」「档案」三类功能：

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          系统功能三层架构                                 │
│                                                                         │
│  ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐  │
│  │  服务作业台        │  │  技术知识支撑      │  │  档案和基础信息    │  │
│  │  (Workbench)      │  │  (Tech Hub)       │  │  (Archives)       │  │
│  ├───────────────────┤  ├───────────────────┤  ├───────────────────┤  │
│  │ 处理每天变动的     │  │ 获取解决能力的     │  │ 管理基础资源       │  │
│  │ 工单（动态作业）   │  │ 知识中心           │  │ （基石数据库）     │  │
│  ├───────────────────┤  ├───────────────────┤  ├───────────────────┤  │
│  │ • 咨询工单        │  │ • Kinefinity Wiki │  │ • 客户档案         │  │
│  │ • RMA返厂单       │  │ • 智能问答(Bokeh) │  │ • 设备资产         │  │
│  │ • 经销商维修单    │  │ • 公告与培训      │  │ • 物料与价目       │  │
│  └───────────────────┘  └───────────────────┘  └───────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.1 服务作业台 (Workbench)

> **客服和工程师的一线战场**：处理每天变动的工单。

#### 3.1.1 咨询工单处理

**功能入口**：`/workbench/inquiry-tickets`

**核心功能**：

| 功能 | 说明 | 角色权限 |
|-----|------|----------|
| 工单列表与筛选 | 按状态、优先级、负责人筛选 | 市场部(全部)、经销商(自己客户) |
| 工单详情与回复 | 查看完整沟通历史、添加回复 | 市场部、经销商 |
| 知识库快速引用 | 从知识库拖拽内容到回复框 | 市场部、经销商 |
| 转RMA/维修单 | 判断需要维修时升级工单 | 市场部、一级经销商 |
| 客户上下文 | 自动显示客户历史、设备信息 | 市场部(全部)、经销商(自己客户) |

**典型场景 - 经销商处理咨询**：
```
John 发邮件给 ProAV: "Edge 8K拍摄4K 50fps时会死机"
    ↓
ProAV 在【服务作业台】看到新咨询工单 K2602-0005
    ↓
点击工单，右侧自动显示：
  • 客户上下文：John, MAVO Edge 8K (ME_207890), 在保至2027-03-15
  • 历史工单：2个（均已解决）
  • AI建议：检查固件版本、查看KB-0089
    ↓
ProAV 查询知识库，找到相关排查步骤
    ↓
拖拽知识库内容到回复框，发送给John
    ↓
排查无效 → 点击「转为RMA」
    ↓
系统自动生成 RMA-D-2602-0010，跳转到RMA详情页
```

#### 3.1.2 RMA返厂单处理

**功能入口**：`/workbench/rma-tickets`

**核心功能**：

| 功能 | 说明 | 角色权限 |
|-----|------|----------|
| RMA创建 | 从咨询升级 / 直接创建 | 市场部、经销商 |
| 设备资产自动关联 | 输入SN码自动查询保修状态 | 所有 |
| 保修状态判定 | 自动判定保内/保外，计算费用 | 系统自动 |
| 备件调用与报价 | 从物料库选择配件，自动计算价格 | 市场部、生产部 |
| 维修流程跟踪 | 物流→收货→检测→维修→发货 | 市场部、生产部 |
| 异常审批 | 超预估费用需客户确认 | 市场部审批 |

**典型场景 - 市场部处理RMA**：
```
【服务作业台】收到新RMA RMA-D-2602-0010
    ↓
打开RMA详情页，系统自动去【设备资产】里查SN码：
  • MAVO Edge 8K (ME_207890)
  • 购买日期：2026-01-05
  • 保修状态：在保（还有13个月）
  • 历史维修：无
    ↓
生产部收货，开始检测
    ↓
发现：主板有腐蚀，需更换主板
    ↓
点击「添加备件」，从【物料与价目】选择：
  • S3-800-002-01 Edge主板 $799
  • 因在保，客户价格 $0
    ↓
维修完成，状态更新为「待发货」
    ↓
John 的【客户档案】里，这台机器的记录下多了一行维修历史
```

#### 3.1.3 经销商维修单处理

**功能入口**：`/workbench/dealer-repairs`

**核心功能**：

| 功能 | 说明 | 角色权限 |
|-----|------|----------|
| 维修单创建 | 经销商提交 / 市场部代创建 | 一级经销商、市场部 |
| 备件库存检查 | 调用【物料与价目】查看库存 | 一级经销商 |
| 价格计算 | 自动判定保内/保外价格 | 系统自动 |
| 备件消耗记录 | 使用库存配件，自动扣减 | 一级经销商 |
| 维修完成记录 | 填写维修内容，关闭维修单 | 一级经销商 |

**典型场景 - 一级经销商本地维修**：
```
ProAV客户报告Edge SDI无输出
    ↓
ProAV判断：可使用库存配件本地维修
    ↓
在【服务作业台】创建【经销商维修单】SVC-D-2602-0001
    ↓
系统自动去【物料与价目】查：
  • S1-011-013-01 SDI模块
  • ProAV库存：3个
  • 保外价格：$69
  • 客户在保，价格$0
    ↓
ProAV自行维修，点击「使用配件」
    ↓
系统自动：
  • 扣减ProAV库存：3 → 2
  • 记入月度结算
  • 更新客户维修历史
    ↓
维修完成，SVC-D-2602-0001关闭
```

#### 3.1.4 工单协作功能

**通用于所有工单类型**：

##### 3.1.4.1 评论与跟进

| 功能 | 说明 |
|-----|------|
| 内部评论 | @同事协作，仅内部可见 |
| 跟进提醒 | 自动通知被@人员 |
| 评论可见性 | 支持内部/客户可见切换 |

##### 3.1.4.2 附件管理（图片/视频）

**上传限制**：

| 文件类型 | 单文件限制 | 单工单限制 | 说明 |
|---------|-----------|-----------|----- |
| 图片 | 10 MB | 10 张 | 支持 JPG/PNG/HEIC |
| 视频 | 100 MB | 3 个 | 支持 MP4/MOV |

**待讨论**：
- [ ] 是否需要自动压缩？(图片压缩到2MB以下？)
- [ ] 视频是否需要转码？(统一转为H.264 MP4？)
- [ ] 是否需要更大的视频限制？(如通过分片上传支持500MB?)

**存储方案**：

| 方案 | 说明 | 优缺点 |
|-----|------|----------|
| **方案A: 本地存储**(当前) | `server/data/issue_attachments/{issue_id}/{filename}` | 优：简单、无额外成本<br>缺：容量受限、无CDN加速 |
| **方案B: 对象存储**(待讨论) | 阿里云OSS / AWS S3 | 优：无限容量、CDN加速、更安全<br>缺：额外成本、需要配置 |

**访问控制**：

需求：
- 工单附件仅限有权限的用户访问
- 不能通过猜测URL直接下载

方案：
1. **Token验证**: 访问附件需要有效的JWT Token
2. **签名URL** (如用对象存储): 生成有时效的签名链接
3. **代理下载**: 通过API代理下载，验证权限后返回文件

**预览方式**：
- 图片: 缩略图预览 + 原图查看
- 视频: 内嵌播放器 (HTML5 Video)
- iOS: 支持相册选取、拍照上传

##### 3.1.4.3 状态流转

| 功能 | 说明 |
|-----|------|
| 可视化状态机 | 展示工单当前状态和可执行操作 |
| 自动推进流程 | 根据规则自动执行下一步骤 |

##### 3.1.4.4 通知提醒

| 通知渠道 | 使用场景 |
|---------|----------|
| 邮件 | 工单状态变更、重要提醒 |
| App推送 | 实时通知(iOS/Android) |
| 企业微信 | 内部团队协作 |

##### 3.1.4.5 历史追溯

| 功能 | 说明 |
|-----|------|
| 完整操作日志 | 记录谁在什么时间做了什么 |
| 变更对比 | 支持查看字段修改前后对比 |

### 3.2 技术知识支撑 (Tech Hub)

> **获取解决能力的知识中心**：查找如何修、如何回、产品参数。

#### 3.2.1 Kinefinity Wiki（技术百科）

> 参考现有知识库：EAGLE知识库.xlsx、Knowledge base_Edge.xlsx、固件Knowledge Base.xlsx

**功能入口**：`/tech-hub/wiki`

##### 3.2.1.1 内容组织

```
Kinefinity Wiki
├── 产品族群（按A/B/C/D类）
│   ├── MAVO Edge系列
│   │   ├── Edge 8K技术规格
│   │   ├── Edge 6K技术规格
│   │   ├── 常见问题FAQ
│   │   ├── 功能介绍
│   │   └── 维修手册（权限：Internal）
│   ├── MAVO mark2系列
│   ├── TERRA系列
│   ├── EAGLE EVF
│   └── 通用知识
│       ├── 固件升级指南
│       ├── 兼容性列表
│       └── 保修政策
└── 归档产品（历史机型）
```

##### 3.2.1.2 知识分类体系

| 分类 | 说明 | 示例 | 来源参考 |
|-----|------|------|---------|
| **FAQ** | 常见问题与标准答案，区分内外部回答 | Eagle HDMI是否支持3D LUT导入？ | EAGLE知识库.xlsx |
| **故障排查 (Troubleshooting)** | 现象 → 多步骤排查流程 | 屏幕不亮 → 检查供电 → 检查开关 → 更换线缆... | EAGLE知识库-Troubleshooting |
| **兼容性列表** | 设备/配件兼容性测试结果 | Eagle HDMI + Sony FX6 + 1080p 50fps = ✓ | EAGLE知识库-兼容性表 |
| **固件知识** | 版本差异、新功能、已知问题 | 8023固件新增Uncompressed RAW | 固件Knowledge Base.xlsx |
| **基础知识** | 菜单含义、参数说明、操作指南 | 固件升级时数字1-12各代表什么模组 | Knowledge base_Edge-基础知识 |
| **问题案例库** | 历史问题的详细记录与解决方案 | Edge 8K死机案例 + 解决方法 | Knowledge base_Edge |
| **维修手册** | 内部维修指南 (仅内部) | 更换Sensor步骤 | Internal Only |

##### 3.2.1.3 问题分类维度

（来自现有知识库）

| 问题大类 | 问题小类 |
|---------|---------|
| **稳定性** | 无法开机、死机、画面异常、温度异常 |
| **素材** | 横条/白线/红点、色彩异常、素材号重复、录制异常 |
| **监看** | KineMON无画面、画面异常、功能BUG、触屏、SDI、颜色 |
| **SSD** | FLUSH、无法识别 |
| **音频** | 音频不完整、杂音/噪声/电流声 |
| **兼容性** | 第三方设备兼容问题 |
| **时码** | 时码显示/同步问题 |
| **硬件/结构** | ND、灰尘、风扇、人为损坏 |

##### 3.2.1.4 FAQ条目结构 (内外部答案分离)

```
FAQ条目 {
  id: 唯一标识
  question: 问题描述
  
  // 答案分层 - 关键特性
  external_answer: 外部回答 (给客户/经销商看)
  internal_answer: 内部回答 (更详细的技术细节，仅员工可见)
  
  ### 6.1
  products: [关联产品列表]
  firmware_versions: [相关固件版本]
  tags: [标签列表]
  
  ### 6.1
  images: [图片列表]
  videos: [视频列表]
  
  // 元数据
  created_by, updated_by, created_at, updated_at
}
```

**示例** (来自EAGLE知识库):
```
问题: Eagle HDMI是否能控制相机的录制？
外部回答: 相机无法通过HDMI来控制录制，SDI和HDMI均为单向通信，只能传输元数据
内部回答: 相机是无法通过HDMI来控制的，只能是相机的录制状态通过HDMI传出给外部monitor或recorder；
         SDI也是单向通信，元数据包含录制状态、TC和Audio
```

##### 3.2.1.5 Troubleshooting条目结构

```
Troubleshooting条目 {
  id: 唯一标识
  phenomenon: 问题现象 (如: "屏幕不亮、Logo灯、录制灯不亮")
  
  // 排查步骤 - 有序列表，支持分支
  steps: [
    { order: 1, action: "检查供电线缆是否插好，特别是0B5P的", next_if_fail: 2 },
    { order: 2, action: "检查Eagle电源开关是否打开", next_if_fail: 3 },
    { order: 3, action: "更换线缆尝试", next_if_fail: 4 },
    { order: 4, action: "使用USB-A转USB-C线测试...", 
      result_if_pass: "线缆或内部软排线问题",
      result_if_fail: "需更换主板" }
  ]
  
  ### 6.1
  products: [关联产品]
  related_cases: [相关工单/案例]
}
```

##### 3.2.1.6 兼容性列表结构

```
兼容性条目 {
  id: 唯一标识
  compatibility_type: 类型 (HDMI输入/HDMI输出/Type-C供电/元数据支持)
  
  // 测试对象
  our_product: 我方产品 (Eagle HDMI/Eagle SDI)
  external_device: 外部设备型号 (Sony FX6)
  external_device_brand: 品牌 (Sony)
  
  // 测试参数
  interface_type: 接口类型 (全尺寸HDMI A / Micro HDMI D)
  resolution: 分辨率 (1080p / 2160p)
  frame_rate: 帧率 (50 / 59.94)
  
  // 测试结果
  is_compatible: 是否兼容 (✓ / ✕)
  notes: 备注
  
  // 元数据支持 (针对特定类型)
  supports_rec_status: 录制状态显示
  supports_vu_meter: VU表
  supports_timecode: 时码
  
  // 测试信息
  tested_date: 测试日期
  tested_by: 测试人员
  firmware_version: 测试时固件版本
}
```

##### 3.2.1.7 问题案例结构

(来自Knowledge base_Edge)

```
问题案例 {
  id: 唯一标识
  
  // 问题分类
  category: 问题大类 (稳定性/素材/监看/SSD/...)
  sub_category: 问题小类 (无法开机/死机/画面异常/...)
  
  // 问题描述
  phenomenon: 具体现象
  analysis: 问题分析
  
  // 售后步骤
  service_steps: [售后处理步骤列表]
  
  // 具体案例
  cases: [{
    date: 反馈时间,
    product_model: 机型 (Edge 8K / Edge 6K),
    firmware_version: 固件版本,
    reporter: 反馈人,
    description: 详细描述,
    media_links: [图片/视频链接],
    solution: 解决方法,
    serial_number: 序列号 (可选)
  }]
  
  // 生产工艺变更提示
  manufacturing_notes: 生产工艺变更说明
}
```

##### 3.2.1.8 固件知识结构

```
固件知识条目 {
  id: 唯一标识
  firmware_version: 固件版本 (如: 8023)
  compare_version: 对比版本 (如: 7314/7318)
  
  // 新功能
  new_features: [{
    name: 功能名称,
    description: 功能说明
  }]
  
  // 问题与解答
  qa_items: [{
    category: 分类 (RAW/ProRes BT.2020/自定义按键/其他),
    question: 问题,
    answer: 答案,
    notes: 备注
  }]
}
```

##### 3.2.1.9 权限分级

| 可见性 | 说明 | 可见内容 | 内容示例 |
|----------|------|---------|----------|
| **Public** | 完全公开(3.0阶段向终端用户开放) | 外部回答、基础兼容性列表、产品说明书 | MAVO Edge 6K操作说明书 |
| **Dealer** | 经销商可见 | Public + 维修手册、产品知识库 | EAGLE维修手册、Knowledge base_Edge |
| **Internal** | 内部员工 | 全部内容 (含内部回答、敏感资料) | 内部分析报告、成本信息等 |
| **Department** | 特定部门 | 如维修手册仅售后/研发可见 | 生产工艺资料 |

**创建条目时的权限管理**：
- 创建者选择权限级别
- 不同发布版本可设置不同权限（如Beta版仅Internal）
- 支持条目的权限历史追溯

##### 3.2.1.10 组织方式

采用 **混合模式**：
- **按产品线组织**: Eagle系列 / MAVO Edge系列 / TERRA系列
- **按知识类型组织**: FAQ / Troubleshooting / 兼容性 / 固件知识
- **通用知识库**: 跨产品的通用内容

```
知识库
├── 产品知识
│   ├── Eagle HDMI
│   │   ├── FAQ
│   │   ├── Troubleshooting
│   │   ├── 兼容性列表
│   │   └── 问题案例
│   ├── Eagle SDI
│   ├── MAVO Edge 8K
│   └── ...
├── 固件知识
│   ├── 8.0 (8023)
│   ├── 7.3 (7314)
│   └── ...
└── 通用知识
    ├── SSD使用指南
    ├── 供电方案
    └── ...
```

##### 3.2.1.11 知识库维护流程

```
创建知识 → 审核 → 发布
             ↓
          修订 → 审核 → 发布新版本
```

**角色权限**:
- **查看者**: 只能浏览
- **编辑者**: 可创建/编辑草稿
- **审核者**: 可审核发布
- **管理员**: 可删除/设置权限

##### 3.2.1.12 知识库与工单联动

- 创建工单时: 智能推荐相关知识 (基于问题描述)
- 处理工单时: 可引用知识库内容作为解决方案
- 关闭工单时: 可将解决方案沉淀为新知识条目

**特点**：
- 图文并茂的网页形式
- 支持版本管理（固件版本对应）
- 支持多语言（中/英）

#### 3.2.2 智能问答 (Smart Q&A)

**功能入口**：全局快捷键 `Cmd/Ctrl + K`

**核心组件**：**Bokeh / 小波** - AI助手

##### Bokeh 设计规范

**1. 核心视觉识别**

**角色形态**：一团"有生命力的光"
- 形态：边缘柔和、边界不明确的发光球体，时刻在缓慢流动、变形，像大光圈镜头下的焦外光点
- 色彩：青色(Teal #00BFA5)到淡紫色(Lavender #8E24AA)渐变，适配暗黑模式
- 关键词：Ethereal（空灵）、Bioluminescent（生物发光）、Calm（平静）、Responsive（响应式）

**动态语言**：
- **呼吸(Breathing)**：待机时缓慢的透明度和大小微弱变化，像呼吸一样
- **对焦(Focusing)**：思考时快速收缩变实，再散开变虚，模拟镜头对焦过程

**2. 交互设计 - 三种形态**

**形态A：休眠态 - "灵动光点" (The Orb)**

```
外观：
  ┌────────────────────────────────────────────────┐
  │                                      [○]       │  ← 48px半透明光点
  │                                                │    吸附在右下角
  │                                                │
  │                                   Ask Bokeh    │  ← Hover时显示Tooltip
  │                                    (⌘K)        │
  └────────────────────────────────────────────────┘

交互：
  • Hover：光点变亮、变大
  • 拖拽：可拖到屏幕任何边缘吸附
  • 投喂：拖拽截图到光点 → 光点变成"黑洞"吸入图片 → 展开对话框分析
```

**形态B：激活态 - "侧边助理" (The Panel)**

```
触发方式：
  • 点击光点
  • 全局快捷键：Cmd + K (Mac) / Ctrl + K (Win)

展开动画：
  光点像墨水滴入水中一样"晕染"，展开成磨砂玻璃面板

布局：
  ┌─────────────────────────────────────────┐
  │ [○] Bokeh Assistant          [_] [×]   │  ← 头部
  ├─────────────────────────────────────────┤
  │                                         │
  │  💬 Bokeh: 您需要关于 SVC-D-2602-005   │
  │            的帮助吗？我可以帮您...      │
  │                                         │  ← 对话区
  │  👤 你: 查询这个RMA的物流状态           │
  │                                         │
  │  💬 Bokeh: 正在查询物流信息...         │
  │                                         │
  ├─────────────────────────────────────────┤
  │ [ 📦 查询RMA物流 ] [ 📄 Edge说明书 ]    │  ← 快捷胶囊按钮
  ├─────────────────────────────────────────┤
  │  输入您的问题...                📎 📷   │  ← 输入区
  └─────────────────────────────────────────┘
```

**形态C：迷你态 - "聚焦搜索" (The Spotlight)**

类似macOS Spotlight，适用于快速问答：

```
场景：用户只想知道简单参数

显示：
  ┌─────────────────────────────────────────────────┐
  │                                                 │
  │     ┌─────────────────────────────────────┐    │
  │     │ MAVO Edge 8K最高帧率？              │    │  ← 中央长条输入框
  │     └─────────────────────────────────────┘    │
  │     ┌─────────────────────────────────────┐    │
  │     │ 8K 30fps / 6K 60fps / 4K 120fps     │    │  ← 答案直接展开
  │     │ [查看完整规格] [关闭]                │    │
  │     └─────────────────────────────────────┘    │
  │                                                 │
  └─────────────────────────────────────────────────┘

特点：看完即走，无需打开完整面板
```

**3. 关键功能体验**

**上下文感知 (Context Awareness)**：
```
场景：用户正在浏览 SVC-D-2602-0005 维修单
  ↓
用户呼出Bokeh (Cmd+K)
  ↓
Bokeh开场白：
  "您需要关于 SVC-D-2602-0005 的帮助吗？
   我可以帮您催审或检查备件库存。"
  ↓
省去用户描述背景的时间
```

**智能预判 (Quick Actions)**：
- 对话框打开时，不显示空白的"有什么可以帮您？"
- 在输入框上方提供3-4个基于当前热门问题的**快捷胶囊按钮**：
  - [ 📦 查询 RMA 物流 ]
  - [ 📄 MAVO mark2 说明书 ]
  - [ 🔍 错误代码查询 ]

**思考状态表达**：
- 查询数据库时，不用传统的"三个点(...)"加载动画
- 显示："Bokeh is focusing..."（Bokeh正在对焦...）
- 同时，顶部光团进行微妙的虚实变化动效

**最小化与召回**：
- 点击最小化 → 面板有"回吸"动画，嗖的一下缩回右下角光点
- 如Bokeh正在处理耗时任务（如分析大日志），光点旁边有微小的进度环转动

**4. 核心能力**

| 功能 | 说明 | 技术实现 |
|-----|------|----------|
| 故障排查树 | 结构化Troubleshooting流程 | 决策树+向量检索 |
| AI对话 | 自然语言问答 | LLM+RAG（Wiki+历史工单） |
| 实时FAQ匹配 | 输入时即时推荐相关FAQ | 语义搜索 |
| 图片分析 | 拖拽截图识别错误信息 | OCR+多模态LLM |

**5. 权限与范围**

| 角色 | Bokeh可访问的知识范围 |
|-----|----------------------|
| 客户 | Public Wiki + 公开FAQ |
| 经销商 | Dealer Wiki + 经销商FAQ + 自己客户的工单历史 |
| 内部员工 | Internal Wiki + 全部工单历史 |

##### 3.2.2.2 AI系统技术实现

**系统架构**：

```
用户提问 → AI问答引擎(本地知识库+在线知识源) → 上下文整合 → LLM生成 → 智能回答
```

**查询入口**：
- 公开用户：官网聊天窗口/小程序（Public知识）
- 经销商：登录后问答（Dealer知识+自己客户工单）
- 内部员工：工单系统内置（全部知识库）

**查询模式**：
1. 直接问答：自然语言问题 → AI检索+生成答案+引用来源
2. 引导式Troubleshooting：逐步询问 → 排查树引导 → 解决方案
3. 传统文档搜索：关键词搜索+分类浏览

**AI服务商推荐**：
- 国内优先：DeepSeek/智谱GLM-4-Air (￥10-30/月)
- 国外优先：Groq(Llama 3)免费 + OpenAI GPT-4o-mini备用
- 向量检索：SQLite+sqlite-vec / ChromaDB
- Embedding：智谱Embedding-2(免费) / BGE-M3(本地)

**AI应用场景**：
- 知识库+工单联合查询：带引用索引[KB-XXX]/[工单#XXX]
- 工单分析：模式识别/趋势预警/根因分析/聚类/方案推荐
- 查询辅助：意图理解 → 结构化查询 → 洞察生成
- 自动标签：工单分类/优先级/知识提取/重复识别
- 报告生成：自动汇总+分析+趋势识别+结构化输出
- 多语言：知识库翻译/工单翻译/跨语言问答

**实现优先级**：
- Phase 1: 工单分类/回复建议/知识提取/故障诊断/报告摘要
- Phase 2: 高频问题/相似工单/补货建议/批次预警/自动起草
- Phase 3: 分配建议/更新建议/自然语言查询/情绪识别/异常检测/多语言

#### 3.2.3 公告与培训 (Announcements)

**功能入口**：`/tech-hub/announcements`

**内容类型**：

| 类型 | 说明 | 权限 |
|-----|------|------|
| 内部技术通告 | 新产品技术要点、批次问题警示 | Internal |
| 新产品培训资料 | 产品培训PPT、视频 | Dealer+ |
| 固件发布知识 | 固件更新日志、已知问题 | Public |

### 3.3 档案和基础信息 (Archives)

> **系统的基石数据库**：管理客户、设备、物料等基础资源。

#### 3.3.1 客户档案 (Customers)

**功能入口**：`/archives/customers`

**视图A：渠道伙伴 (Dealers)**

```
列表页：
  ┌─────────────────────────────────────────────────────────┐
  │ ProAV (英国) | 一级经销商 | 维修单: 15 | 库存: 充足     │
  │ Gafpa (欧洲) | 一级经销商 | 维修单: 23 | 库存: 正常     │
  │ DP Gadget (东南亚) | 二级经销商 | 维修单: 8 | 库存: 无 │
  └─────────────────────────────────────────────────────────┘

点击ProAV详情页：
  ┌─────────────────────────────────────────────────────────┐
  │ ProAV - 一级经销商                                       │
  ├─────────────────────────────────────────────────────────┤
  │ 基本信息：                                               │
  │   地区: 英国/部分欧洲                                     │
  │   联系人: Mike Johnson                                   │
  │   维修能力: 强 | 配件库存: 有                             │
  ├─────────────────────────────────────────────────────────┤
  │ Service Dashboard:                                      │
  │   本月维修单: 15 | 本月咨询: 47 | 库存周转率: 2.3       │
  ├─────────────────────────────────────────────────────────┤
  │ 备件库存（一级经销商专属）:                               │
  │   SDI模块: 3 | Edge主板: 1 | 风扇: 5                     │
  │   [库存明细] [补货申请]                                  │
  ├─────────────────────────────────────────────────────────┤
  │ 维修单列表:                                              │
  │   SVC-D-2602-0001 | Edge SDI维修 | 已完成              │
  │   SVC-D-2602-0005 | mark2按键板 | 进行中              │
  │   [查看全部]                                            │
  └─────────────────────────────────────────────────────────┘
```

**视图B：终端用户 (End-Users)**

```
列表页：
  ┌─────────────────────────────────────────────────────────┐
  │ John Smith | ProAV客户 | Edge 8K | 工单: 3 | VIP       │
  │ Max Chen   | 直客      | mark2  | 工单: 1 | 标准      │
  └─────────────────────────────────────────────────────────┘

点击John详情页：
  ┌─────────────────────────────────────────────────────────┐
  │ John Smith - 终端用户                                    │
  ├─────────────────────────────────────────────────────────┤
  │ 客户上下文（之前定义的完整模型）:                         │
  │                                                         │
  │ 设备列表:                                                │
  │   MAVO Edge 8K (ME_207890) | 在保至2027-03-15          │
  │   Eagle HDMI (EH_104523)   | 已过保                    │
  │                                                         │
  │ 历史工单:                                                │
  │   K2602-0001: 咨询-死机问题 → 已升级为RMA               │
  │   RMA-D-2602-0010: 主板腐蚀维修 → 已完成                │
  │   K2512-0847: 咨询-高帧率设置 → 已解决                  │
  │                                                         │
  │ 维修记录:                                                │
  │   2026-02-15: Edge 8K主板更换 (RMA-D-2602-0010)        │
  │   费用: $0 (保内)                                       │
  │                                                         │
  │ 经销商关联:                                              │
  │   销售经销商: ProAV (英国)                               │
  │   服务经销商: ProAV (英国)                               │
  │                                                         │
  │ AI客户画像:                                              │
  │   标签: 高频用户 | 技术能力强 | 偏好邮件沟通 | VIP      │
  │   提示: 此客户曾提出过2个功能期望，均已纳入规划          │
  └─────────────────────────────────────────────────────────┘
```

#### 3.3.2 设备资产 (Installed Base)

**功能入口**：`/archives/installed-base`

**核心功能**：

```
全局SN码搜索：
  ┌─────────────────────────────────────────────────────────┐
  │ 搜索: [ME_207890]                          [🔍]         │
  └─────────────────────────────────────────────────────────┘
  ↓
设备上下文（之前定义的完整模型）：
  ┌─────────────────────────────────────────────────────────┐
  │ MAVO Edge 8K (ME_207890)                                │
  ├─────────────────────────────────────────────────────────┤
  │ 出厂信息:                                                │
  │   生产批次: 2026Q1-001                                   │
  │   出厂日期: 2026-01-05                                   │
  │   硬件版本: PCB v3.2                                     │
  │   固件版本: 8023 (当前)                                  │
  │                                                         │
  │ 保修状态:                                                │
  │   购买日期: 2026-01-15                                   │
  │   保修期至: 2027-01-15 (还有11个月)                      │
  │   状态: ✅ 在保                                          │
  │                                                         │
  │ 历史维修记录:                                            │
  │   2026-02-15 | RMA-D-2602-0010 | 主板腐蚀更换           │
  │   费用: $0 (保内) | 处理人: 黄碧珊                       │
  │                                                         │
  │ 当前用户:                                                │
  │   John Smith (john@example.com)                        │
  │   销售经销商: ProAV (英国)                               │
  │                                                         │
  │ 与工单的双向关联:                                        │
  │   K2602-0001: 咨询工单 (已关闭)                         │
  │   RMA-D-2602-0010: RMA返厂单 (已完成)                   │
  └─────────────────────────────────────────────────────────┘
```

**从工单调用设备信息**：
- 在任何工单中输入SN码
- 系统自动弹出设备上下文气泡
- 点击气泡跳转到设备详情页

#### 3.3.3 物料与价目 (Materials & Pricing)

**功能入口**：`/archives/materials`

**整合内容**：
- 原2.2节：维修配件SKU体系
- 原2.4节：Edge前部维修方案矩阵

**核心功能**：

| 功能 | 说明 | 角色权限 |
|-----|------|----------|
| SKU列表 | 74个配件的完整清单 | 所有内部员工 |
| 标准工时费 | Labor Rates按区域定价 | 市场部、生产部 |
| 价格策略 | 经销商价/直客价/保内价/保外价 | 市场部 |
| 库存状态 | 总部库存 + 各一级经销商库存 | 市场部、生产部、一级经销商 |
| Edge前部维修方案矩阵 | 原2.4节内容 | 生产部、一级经销商 |

**库存管理**：
```
总部库存视图（市场部/生产部）：
  ┌─────────────────────────────────────────────────────────┐
  │ SKU            | 配件名称      | 总部库存 | 经销商总库存│
  ├─────────────────────────────────────────────────────────┤
  │ S1-011-013-01 | SDI模块       | 45       | 12          │
  │   ├ ProAV: 3                                            │
  │   ├ Gafpa: 5                                            │
  │   └ 1SV: 4                                              │
  ├─────────────────────────────────────────────────────────┤
  │ S3-800-002-01 | Edge主板      | 8        | 3           │
  │   ├ ProAV: 1                                            │
  │   ├ Gafpa: 2                                            │
  │   └ 1SV: 0 ⚠️ 低于安全线                                │
  └─────────────────────────────────────────────────────────┘

经销商库存视图（一级经销商）：
  ┌─────────────────────────────────────────────────────────┐
  │ SKU            | 配件名称      | 我的库存 | 状态        │
  ├─────────────────────────────────────────────────────────┤
  │ S1-011-013-01 | SDI模块       | 3        | 正常        │
  │ S3-800-002-01 | Edge主板      | 1        | 正常        │
  │ S4-000-003-01 | 风扇          | 0        | ⚠️ 缺货     │
  │                                          [申请补货]      │
  └─────────────────────────────────────────────────────────┘
```

### 3.4 洞察与反馈中心 (Insights & Feedback)

> 从海量工单数据中提取洞察，驱动产品迭代和质量改进

**功能入口**：`/insights`

**核心价值**：将分散的工单、维修、反馈数据转化为可执行的产品洞察和质量改进行动

---

#### 3.4.1 质量仪表盘 (Quality Dashboard)

**功能定位**：产品质量的晴雨表，管理层和质量部门的核心决策工具

**核心指标**：

##### A. 返修率统计 (RMA Rate)

按不同维度统计返修率，快速定位质量问题区域：

| 统计维度 | 示例 | 计算方式 | 应用场景 |
|---------|------|---------|----------|
| **按机型** | Edge 6K: 3.2%<br>MAVO LF: 1.8% | 返修台数 / 出货台数 | 对比不同产品线质量 |
| **按批次** | 2026Q1-001: 5.1% ⚠️<br>2026Q1-002: 1.2% | 该批次返修 / 该批次出货 | 定位问题批次，快速召回 |
| **按地区** | 欧洲: 2.5%<br>北美: 1.9% | 该地区返修 / 该地区出货 | 分析区域性问题（运输/环境） |
| **按经销商** | ProAV: 4.2%<br>Gafpa: 1.5% | 该经销商返修 / 该经销商出货 | 识别经销商操作/仓储问题 |
| **按时间段** | Q1: 2.8%<br>Q2: 3.5% ↗️ | 季度返修 / 季度出货 | 趋势监控，预警质量恶化 |

**可视化展示**：
```
返修率趋势图（按月）：
5%  ┤           ╭─╮
4%  ┤       ╭─╯ ╰╮
3%  ┤   ╭─╯     ╰─╮  ← 安全线 (3%)
2%  ┤ ╭╯          ╰╮
1%  ┼─────────────────
    Q1 Q2 Q3 Q4 Q1 Q2
    2025      2026

⚠️ 预警：2026 Q1-001批次返修率5.1%，超出安全线68%
```

##### B. 故障帕累托图 (Defect Pareto)

**TOP 10 故障组件排行**：识别"关键少数"故障，集中资源解决

```
故障组件分布（2026 Q1）：

组件名称            故障次数   占比    累计占比
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
SDI接口烧毁            45      30%     30%  ████████████
SSD卡槽弹簧失效         30      20%     50%  ████████
Fan风扇轴承磨损         22      15%     65%  ██████
主板电容鼓包            18      12%     77%  ████
触摸屏排线松动          10       7%     84%  ██▌
ND滤镜卡死              8       5%     89%  ██
电池仓接触不良           6       4%     93%  █▌
HDMI输出无画面          5       3%     96%  █
Sensor坏点              3       2%     98%  ▌
机身螺丝滑丝            3       2%    100%  ▌

💡 洞察：前3项占65%，集中改进这3个组件可解决大部分问题
```

**帕累托原则应用**：
- 80/20法则：80%的返修问题通常由20%的组件缺陷导致
- 改进优先级：优先解决前5名故障，投入产出比最高

##### C. 质量看板可视化

```
┌────────────── 质量仪表盘 (2026 Q1) ──────────────┐
│                                                 │
│  总返修率: 2.8% ↗ (+0.5% vs Q4)                 │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━                    │
│  安全线: 3.0%        [距离预警: 0.2%]            │
│                                                 │
│  🔴 高风险批次 (1个)                             │
│     2026Q1-001: 5.1% (已标记召回评估)            │
│                                                 │
│  🟡 关注机型 (2个)                               │
│     MAVO Edge 6K: 3.2% (SDI接口为主)            │
│     TERRA 4K: 2.9% (风扇问题为主)               │
│                                                 │
│  🟢 优秀表现                                     │
│     MAVO LF: 1.8% (连续3季度低于2%)             │
│     KineEVF: 1.2% (新产品质量稳定)              │
│                                                 │
│  📊 快速链接                                     │
│  [查看详细报告] [导出Excel] [设置预警阈值]       │
└─────────────────────────────────────────────────┘
```

---

#### 3.4.2 性能指标分析 (Performance Metrics)

**功能定位**：运营效率的度量器，优化服务流程的数据基础

##### A. TAT (Turnaround Time) 分析

**定义**：从收到设备到维修完成发出的平均时长

**维修中心对比**：

| 维修中心 | 平均TAT | 中位数TAT | 最快 | 最慢 | 样本量 |
|---------|---------|----------|------|------|--------|
| **北京总部** | 3.2天 | 3天 | 1天 | 12天 | 156个 |
| **Burbank** | 7.1天 | 6天 | 3天 | 21天 | 89个 |
| **ProAV英国** | 4.5天 | 4天 | 2天 | 14天 | 67个 |
| **Gafpa德国** | 5.8天 | 5天 | 2天 | 18天 | 43个 |

**深度分析 - 为什么Burbank慢？**

```
TAT分解（Burbank vs 北京）：

环节              北京    Burbank   差距    原因分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
收货登记          0.5天   1.2天    +0.7天  时差+人手不足
检测诊断          0.8天   1.5天    +0.7天  技师经验不足
等待配件          0.9天   2.8天    +1.9天  🔴 主要瓶颈：跨国运输
维修作业          0.7天   1.1天    +0.4天  工具配置差异
质检测试          0.3天   0.5天    +0.2天  流程差异
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
总计              3.2天   7.1天    +3.9天

💡 改进建议：
1. 在Burbank建立常用配件本地库存（减少1.5天）
2. 增加1名技师，缩短排队时间（减少0.5天）
3. 优化检测流程，提供远程技术支持（减少0.3天）
预计改进后TAT：4.8天（缩短32%）
```

##### B. SLA达标率

**SLA标准**（服务水平协议）：
- 保内维修：≤5个工作日
- 保外维修：≤7个工作日
- 紧急加急：≤2个工作日（加收费用）

**达标率统计**：

```
2026 Q1 SLA达标情况：

维修中心        总工单   达标   超时   达标率   平均超时天数
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
北京总部         156     148     8     94.9%    2.3天
Burbank          89      71     18     79.8%    4.1天 🔴
ProAV英国        67      61      6     91.0%    2.8天
Gafpa德国        43      38      5     88.4%    3.2天
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
全球总计         355     318     37     89.6%

⚠️ 超时工单分析：
- 缺件等待：18个 (48.6%)
- 疑难故障：10个 (27.0%)
- 客户沟通延迟：6个 (16.2%)
- 其他：3个 (8.1%)

🎯 目标：Q2达标率提升至95%
```

##### C. 高级检索 (Advanced Query)

**跨维度组合搜索**，支持复杂的质量调查和批量召回场景：

**示例查询**：

```sql
查询条件：
[地区 = 英国] 
  AND [产品 = MAVO Edge 6K] 
  AND [故障类型 = SDI接口] 
  AND [保修状态 = 已过保]
  AND [维修时间 = 2025-Q4 至 2026-Q1]

结果：23条记录

快速操作：
  [导出客户联系清单]  ← 用于召回通知
  [批量发送升级提醒]  ← 告知固件修复方案
  [生成质量报告]      ← 提交研发部门
```

**典型应用场景**：

| 场景 | 查询条件 | 目的 |
|-----|---------|------|
| **批次召回** | [批次 = 2026Q1-001] + [故障 = SDI烧毁] | 定位受影响客户，主动召回 |
| **固件推送** | [产品 = Edge 6K] + [故障 = 死机] + [固件 < 8023] | 推送修复固件，减少返修 |
| **经销商审计** | [经销商 = ProAV] + [返修率 > 4%] + [时间 = Q1] | 调查经销商操作问题 |
| **保修分析** | [保修状态 = 刚过保] + [故障 = 主板] + [地区 = 欧盟] | 评估延保策略 |

**权限控制**：
- 市场部：可查询所有客户数据
- 质量部：可查询故障技术细节
- 经销商：仅查询自己客户数据

---

#### 3.4.3 产品进化池 (Product Evolution / VoC)

> Voice of Customer - 将客户声音转化为产品进化的三条路径

**核心理念**：每一条工单背后都可能是产品改进的线索，系统自动识别+人工标记，将反馈精准分流给对应部门

**数据来源**：
- 咨询工单（客服标记）
- RMA返厂单（生产部标记）
- 经销商维修单（经销商上报）
- 内部测试反馈

##### A. Bug流 → 研发/质量部

**定义**：暴露出产品的Bug或设计缺陷

**识别机制**：
- **自动识别关键词**："Bug"、"无法XX"、"一直XX"、"每次都"、"必现"
- **人工标记**：客服/技师在处理工单时勾选"这是Bug"

**数据结构**：

```
product_bugs (Bug流)
├── id
├── bug_number: Bug编号 (BUG-2026-0001)
├── title: Bug标题
├── severity: 严重等级 (Critical/High/Normal/Low)
│   Critical: 导致设备完全无法使用
│   High: 核心功能异常
│   Normal: 功能部分受限
│   Low: 体验问题
│
├── // 问题描述
├── phenomenon: 现象描述 (客户原话)
├── reproduce_steps: 复现步骤 (客服补充)
├── affected_versions: 受影响固件版本列表
├── affected_models: 受影响机型列表
│
├── // 来源追溯
├── source_type: 来源 (咨询工单/RMA工单/内部测试)
├── source_ids: 来源ID列表 (多个工单可能反映同一Bug)
├── reporter_count: 报告人数 (权重)
│
├── // 处理流程
├── status: 状态 (新建/已确认/修复中/已修复/无法复现/非Bug)
├── assigned_to: 负责工程师
├── root_cause: 根因分析
├── fix_plan: 修复方案
│
├── // 修复追踪
├── fixed_in_version: 修复版本 (如: 固件8024)
├── fix_release_date: 发布日期
├── verification_status: 验证状态 (待验证/已验证/复发)
│
└── created_at, updated_at
```

**闭环机制**：

```
Bug修复流程：

1. Bug录入
   客服标记 → 自动创建Bug记录 → 关联所有相关工单
   
2. Bug确认
   研发部门评估 → 确认严重等级 → 分配工程师
   
3. Bug修复
   开发修复 → 内部测试 → 固件版本发布
   
4. 自动通知 🔔
   系统检测到固件发布 
   → 查找受影响客户列表
   → 批量发送邮件/推送：
   
   "尊敬的客户：
   您之前反馈的问题'MAVO Edge录制时突然停止'已在
   固件 v8024 中修复。
   
   [立即下载固件] [查看更新说明]
   
   感谢您的反馈！"
   
5. 效果追踪
   记录通知发送状态 → 追踪固件更新率 → 监控Bug是否复发
```

**典型案例**：

```
BUG-2026-0012: MAVO Edge 8K录制4K 120fps时必现死机

严重等级：Critical
报告人数：23人（来自18个工单）
受影响版本：固件8020-8023
受影响机型：MAVO Edge 8K (仅8K，6K正常)

复现步骤：
  1. 设置分辨率4K，帧率120fps
  2. 录制超过10分钟
  3. 必现死机，需重启

根因分析：
  高帧率下内存缓冲区溢出，看门狗触发重启

修复方案：
  优化内存管理算法，增加缓冲区大小

修复版本：8024 (2026-02-15发布)

闭环通知：
  ✅ 已通知23位客户
  ✅ 18人已更新固件
  ✅ 无复发报告
  
状态：已关闭
```

##### B. 需求流 (Features) → 产品部

**定义**：客户期望的功能或改进建议

**识别机制**：
- **自动识别关键词**："希望"、"建议"、"能不能"、"最好"、"如果有...就好了"
- **人工标记**：客服在工单中勾选"这是功能建议"

**权重累加机制**：

```
同一需求的权重计算：

基础权重 = 提出次数 × 1
客户等级加权 = VIP客户 ×2, KOL ×3
经销商投票 = 经销商请求 ×5

示例：
需求："支持Anamorphic 1.8x变形宽银幕"

提出记录：
  - 12个普通用户     →  12分
  - 3个VIP客户      →  6分
  - 2个KOL          →  6分
  - 5个经销商反馈    →  25分
━━━━━━━━━━━━━━━━━━━━━━━━
  总权重：49分      →  高优先级
```

**数据结构**：

```
feature_requests (需求流)
├── id
├── request_number: 编号 (FR-2026-0001)
├── title: 需求标题
├── description: 详细描述
├── category: 分类 (UI/功能/性能/兼容性/硬件/其他)
├── product_id: 相关产品
│
├── // 权重系统
├── vote_count: 基础投票数（提出次数）
├── weight_score: 加权得分
├── priority_level: 优先级 (P0极高/P1高/P2中/P3低)
│
├── // 来源追溯
├── source_records: 所有相关工单/反馈记录ID列表
├── customer_ids: 所有提出客户ID列表
├── dealer_ids: 提出该需求的经销商列表
│
├── // 产品规划
├── status: 状态 (新建/评估中/已规划/开发中/已发布/已拒绝/已合并)
├── target_version: 目标版本 (如: 固件8025)
├── released_version: 实际发布版本
├── release_date: 发布日期
│
├── // AI辅助
├── ai_similar_ids: AI识别的相似需求（建议合并）
├── ai_feasibility_score: AI评估的可行性得分 (0-100)
│
└── created_at, updated_at
```

**状态流转**：

```
新建 → 评估中 → 已规划 → 开发中 → 已发布
   ↓                              ↓
已拒绝(附原因)             批量通知客户
   ↓
已合并(合并到其他需求)
```

**闭环机制**：

```
功能上线流程：

1. 需求规划
   产品经理评估 → 分配到版本 (如: 固件8025)
   
2. 开发完成
   功能开发 → 测试验证 → 版本发布
   
3. 批量通知 🔔
   系统检测到版本发布
   → 查找target_version = 8025的所有需求
   → 找出所有相关客户（50人）
   → 批量发送邮件：
   
   "好消息！
   
   您在2025年11月期望的功能'Anamorphic 1.8x支持'
   已在固件8025中实现！
   
   同时上线的还有另外12个您关注的功能：
   - ProRes RAW录制
   - ...
   
   [查看完整更新列表] [下载固件]
   
   感谢您的宝贵建议！"
   
4. 反馈收集
   记录客户反馈 → 评估功能效果 → 优化迭代
```

**需求看板**（产品经理视图）：

```
┌─────────── 需求优先级看板 (2026 Q1) ────────────┐
│                                                │
│  🔴 P0 - 极高优先级 (3个)                       │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━         │
│  FR-2026-0015: Anamorphic 1.8x      权重: 49  │
│    👥 50人请求 | 📅 规划至8025 | 产品：Edge     │
│                                                │
│  FR-2026-0023: ProRes RAW           权重: 38  │
│    👥 38人请求 | 📅 规划至8026 | 产品：全系列   │
│                                                │
│  FR-2026-0031: 4K 240fps            权重: 35  │
│    👥 35人请求 | 📅 评估中 | 产品：Edge 8K     │
│                                                │
│  🟡 P1 - 高优先级 (12个)                        │
│  🟢 P2 - 中优先级 (35个)                        │
│  ⚪ P3 - 低优先级 (78个)                        │
│                                                │
│  📊 统计                                        │
│  本季度新增：128个 | 已规划：23个 | 已发布：15个 │
└────────────────────────────────────────────────┘
```

##### C. 原声流 (Voices) → 市场部

**定义**：客户赞扬的话、正面评价、使用心得

**识别机制**：
- **自动识别关键词**："很棒"、"满意"、"专业"、"好用"、"推荐"、"感谢"
- **人工标记**：客服标记"客户赞扬"

**数据结构**：

```
customer_voices (原声流)
├── id
├── voice_number: 编号 (VOICE-2026-0001)
├── content: 原始内容（客户原话）
├── translated_content: 翻译内容（如需要）
│
├── // 分类标签
├── sentiment: 情感 (正面/中性/负面) ← 正面才入库
├── tags: 自动标签 ["画质", "服务", "MAVO Edge"] 
├── highlight_keywords: 高亮关键词 ["色彩还原", "高帧率"]
│
├── // 来源信息
├── source_type: 来源 (咨询工单/RMA工单/社交媒体/邮件)
├── source_id: 来源记录ID
├── customer_id: 客户ID
├── customer_name: 客户姓名
├── customer_title: 客户头衔 (如: "BBC纪录片导演")
├── customer_consent: 客户同意公开引用 (Y/N)
│
├── // 使用场景
├── usage_status: 使用状态 (待审核/已批准/已使用/已过期)
├── used_in: 使用场所 ["官网", "社交媒体", "宣传册"]
├── publish_date: 发布日期
│
└── created_at, updated_at
```

**自动标签系统**：

```
AI标签提取示例：

原始内容：
"MAVO Edge 6K的色彩还原真的太棒了！我用它拍了一部
关于非洲野生动物的纪录片，4K 120fps的高帧率让猎豹
奔跑的画面丝般顺滑。Kinefinity的售后服务也非常专业，
问题响应很快。强烈推荐给同行！"

自动提取标签：
  产品: #MAVO Edge 6K
  场景: #纪录片 #野生动物
  优点: #色彩还原 #高帧率 #4K 120fps #售后服务
  情感: 正面 (置信度: 98%)
  
推荐用途:
  ✅ 官网产品页 - MAVO Edge 6K
  ✅ 社交媒体 - 高帧率功能推广
  ✅ 售后服务宣传
```

**应用场景**：

| 用途 | 使用方式 | 示例 |
|-----|---------|------|
| **官网引用 (Testimonials)** | 客户评价轮播 | 产品页展示真实用户反馈 |
| **社交媒体转发** | 精选好评发布 | Twitter/微博/B站转发客户心得 |
| **案例研究 (Case Study)** | 深度报道 | "BBC导演如何用Edge 6K拍摄野生动物" |
| **内部士气激励** | 月度表彰 | 展示客户认可，激励团队 |
| **销售素材** | 宣传册/PPT | 经销商培训、展会资料 |

**原声库管理**（市场部视图）：

```
┌──────────── 客户原声库 (2026 Q1) ──────────────┐
│                                                │
│  📊 本季度收集：156条正面反馈                   │
│  ✅ 已批准使用：45条                            │
│  📝 待审核：23条                                │
│                                                │
│  🏆 热门标签                                    │
│  #画质  (89)  #服务  (67)  #MAVO Edge  (78)   │
│  #专业  (45)  #推荐  (56)  #高帧率  (34)       │
│                                                │
│  🌟 精选案例                                    │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━         │
│  VOICE-2026-0089                               │
│  "色彩还原真的太棒了！..."                     │
│  来源：RMA-D-2602-0156 (BBC导演)               │
│  标签：#纪录片 #野生动物 #Edge 6K               │
│  状态：✅ 已用于官网                            │
│                                                │
│  [按标签筛选] [导出宣传素材] [申请客户授权]     │
└────────────────────────────────────────────────┘
```

**权限与隐私**：
- ✅ 需客户明确授权才能公开引用
- ✅ 可匿名化处理（"某BBC导演"）
- ✅ 支持撤回授权
- ✅ GDPR/隐私法合规

---

### 3.4 小节总结

**洞察与反馈中心的价值**：

```
              数据输入                  洞察输出
                ↓                        ↓
┌────────────────────────┐    ┌─────────────────────┐
│ 3.1 服务作业台          │    │ 质量改进            │
│   - 咨询工单           │───→│   返修率↓           │
│   - RMA返厂单          │    │   故障TOP10         │
│   - 经销商维修单       │    │   批次召回          │
│                        │    └─────────────────────┘
│ 3.2 Tech Hub           │    ┌─────────────────────┐
│   - 知识库             │───→│ 运营优化            │
│   - Bokeh AI           │    │   TAT缩短           │
│                        │    │   SLA达标率↑        │
│ 3.3 Archives           │    │   成本控制          │
│   - 设备档案           │    └─────────────────────┘
│   - 物料价目           │    ┌─────────────────────┐
└────────────────────────┘───→│ 产品进化            │
                               │   Bug修复→客户通知  │
                               │   需求权重→版本规划  │
                               │   原声流→市场推广    │
                               └─────────────────────┘

💡 核心理念：
   让数据驱动决策，让客户声音驱动产品进化
```

---

## 4. 数据模型设计

> 参考: A02-产品返修记录.xlsx 实际字段结构

### 4.1 工单记录模型

系统采用三层工单模型，清晰区分咨询、返厂维修和经销商本地维修三种场景：

```
客户联系 → 创建咨询工单 → 排查/咨询
                         ├─ 解决 → 关闭咨询工单
                         └─ 需返修 → 升级为RMA返厂单/经销商维修单
```

| 记录类型 | 适用场景 | 特点 |
|---------|---------|---- |
| **咨询工单** | 咨询问答、问题排查、远程协助 | 轻量级，快速记录，系统入口 |
| **RMA返厂单** | 设备寄回总部维修 | 完整流程：物流→检测→维修→结算 |
| **经销商维修单** | 经销商本地维修 | 配件消耗+结算，不寄回总部 |

**转换规则**：
- 咨询工单状态变为“转工单”时，自动创建RMA返厂单或经销商维修单
- RMA/经销商维修单保留原始咨询工单ID，可追溯沟通历史

### 4.2 核心实体

```
products (产品)
├── id, name, model
├── category (电影机/寻像器/配件/线缆)
├── series (Edge/MM2/Terra/Eagle)
├── current_firmware_version
└── created_at

customers (客户)
├── id, name, company, contact_info
├── customer_type (终端客户/KOL/媒体)
├── customer_level (VIP/普通/新客户)
├── country, province, city
├── dealer_id (关联经销商，可为空)
└── created_at

dealers (经销商/渠道商)
├── id, name, code
├── dealer_type (一级代理/二级代理/直营)
├── region (销售大区: 华东/华南/华北/海外)
├── country, province, city
├── contact_info
└── created_at

users (系统用户 - 员工)
├── id, name, email
├── department (市场部/生产部/研发部/管理层)
├── role (admin/editor/viewer)
├── region_responsible (国内/国外，针对市场部)
└── created_at

inquiry_tickets (咨询工单 - 系统入口)
├── id
├── ticket_number: 工单编号 (自动生成)
|---------|------|------|---------|
| 问题趋势 | 时间 (日/周/月) | 数量 | 折线图 |
| 产品问题分布 | 产品型号 | 数量/占比 | 饼图/柱状图 |
| 地区问题热力图 | 国家/省份 | 数量 | 地图/热力图 |
| 问题类别统计 | 问题类别 | 数量/占比 | 柱状图 |
| 经销商问题排行 | 经销商 | 数量 | 排行榜 |
| 处理效率 | 人员/部门 | 平均处理时长 | 柱状图 |
| 批次问题分析 | 批次号 | 问题数/问题率 | 表格 |

**交叉分析示例**:
- 产品 × 问题类别: 哪个产品的哪类问题最多？
- 地区 × 时间: 各地区问题趋势对比
- 经销商 × 产品: 哪个经销商卖的哪个产品问题最多？
- 批次 × 故障现象: 特定批次是否有共性问题？

**导出能力**:
- 查询结果导出 Excel/CSV
- 统计报表导出 PDF
- 定时报表邮件推送 (待讨论)

---

### 4.2 媒体文件管理 (图片/视频)

#### 4.2.1 上传限制

| 文件类型 | 单文件限制 | 单工单限制 | 说明 |
|---------|-----------|-----------|------|
| 图片 | 10 MB | 10 张 | 支持 JPG/PNG/HEIC |
| 视频 | 100 MB | 3 个 | 支持 MP4/MOV |

**待讨论**:
- [ ] 是否需要自动压缩？(图片压缩到 2MB 以下？)
- [ ] 视频是否需要转码？(统一转为 H.264 MP4？)
- [ ] 是否需要更大的视频限制？(如通过分片上传支持 500MB?)

#### 4.2.2 存储方案

**方案 A: 本地存储** (当前)
- 路径: `server/data/issue_attachments/{issue_id}/{filename}`
- 优点: 简单、无额外成本
- 缺点: 容量受限、无CDN加速

**方案 B: 对象存储** (待讨论)
- 使用阿里云 OSS / AWS S3
- 优点: 无限容量、CDN加速、更安全
- 缺点: 额外成本、需要配置

#### 4.2.3 访问控制

**需求**:
- 工单附件仅限有权限的用户访问
- 不能通过猜测 URL 直接下载

**方案**:
1. **Token 验证**: 访问附件需要有效的 JWT Token
2. **签名 URL** (如用对象存储): 生成有时效的签名链接
3. **代理下载**: 通过 API 代理下载，验证权限后返回文件

**预览方式**:
- 图片: 缩略图预览 + 原图查看
- 视频: 内嵌播放器 (HTML5 Video)
- iOS: 支持相册选取、拍照上传

---

### 4.3 知识库系统

> 参考现有知识库：EAGLE知识库.xlsx、Knowledge base_Edge.xlsx、固件Knowledge Base.xlsx

#### 4.3.1 知识分类体系

| 分类 | 说明 | 示例 | 来源参考 |
|-----|------|------|---------|
| **FAQ** | 常见问题与标准答案，区分内外部回答 | Eagle HDMI是否支持3D LUT导入？ | EAGLE知识库.xlsx |
| **故障排查 (Troubleshooting)** | 现象 → 多步骤排查流程 | 屏幕不亮 → 检查供电 → 检查开关 → 更换线缆... | EAGLE知识库-Troubleshooting |
| **兼容性列表** | 设备/配件兼容性测试结果 | Eagle HDMI + Sony FX6 + 1080p 50fps = ✓ | EAGLE知识库-兼容性表 |
| **固件知识** | 版本差异、新功能、已知问题 | 8023固件新增Uncompressed RAW | 固件Knowledge Base.xlsx |
| **基础知识** | 菜单含义、参数说明、操作指南 | 固件升级时数字1-12各代表什么模组 | Knowledge base_Edge-基础知识 |
| **问题案例库** | 历史问题的详细记录与解决方案 | Edge 8K死机案例 + 解决方法 | Knowledge base_Edge |
| **维修手册** | 内部维修指南 (仅内部) | 更换Sensor步骤 | Internal Only |

#### 4.3.2 问题分类维度 (来自现有知识库)

| 问题大类 | 问题小类 |
|---------|---------|
| **稳定性** | 无法开机、死机、画面异常、温度异常 |
| **素材** | 横条/白线/红点、色彩异常、素材号重复、录制异常 |
| **监看** | KineMON无画面、画面异常、功能BUG、触屏、SDI、颜色 |
| **SSD** | FLUSH、无法识别 |
| **音频** | 音频不完整、杂音/噪声/电流声 |
| **兼容性** | 第三方设备兼容问题 |
| **时码** | 时码显示/同步问题 |
| **硬件/结构** | ND、灰尘、风扇、人为损坏 |

#### 4.3.3 FAQ 条目结构 (内外部答案分离)

```
FAQ条目 {
  id: 唯一标识
  question: 问题描述
  
  // 答案分层 - 关键特性
  external_answer: 外部回答 (给客户/经销商看)
  internal_answer: 内部回答 (更详细的技术细节，仅员工可见)
  
  ### 6.1
  products: [关联产品列表]
  firmware_versions: [相关固件版本]
  tags: [标签列表]
  
  ### 6.1
  images: [图片列表]
  videos: [视频列表]
  
  // 元数据
  created_by, updated_by, created_at, updated_at
}
```

**示例** (来自EAGLE知识库):
```
问题: Eagle HDMI是否能控制相机的录制？
外部回答: 相机无法通过HDMI来控制录制，SDI和HDMI均为单向通信，只能传输元数据
内部回答: 相机是无法通过HDMI来控制的，只能是相机的录制状态通过HDMI传出给外部monitor或recorder；
         SDI也是单向通信，元数据包含录制状态、TC和Audio
```

#### 4.3.4 Troubleshooting 条目结构

```
Troubleshooting条目 {
  id: 唯一标识
  phenomenon: 问题现象 (如: "屏幕不亮、Logo灯、录制灯不亮")
  
  // 排查步骤 - 有序列表，支持分支
  steps: [
    { order: 1, action: "检查供电线缆是否插好，特别是0B5P的", next_if_fail: 2 },
    { order: 2, action: "检查Eagle电源开关是否打开", next_if_fail: 3 },
    { order: 3, action: "更换线缆尝试", next_if_fail: 4 },
    { order: 4, action: "使用USB-A转USB-C线测试...", 
      result_if_pass: "线缆或内部软排线问题",
      result_if_fail: "需更换主板" }
  ]
  
  ### 6.1
  products: [关联产品]
  related_cases: [相关工单/案例]
}
```

#### 4.3.5 兼容性列表结构

```
兼容性条目 {
  id: 唯一标识
  compatibility_type: 类型 (HDMI输入/HDMI输出/Type-C供电/元数据支持)
  
  // 测试对象
  our_product: 我方产品 (Eagle HDMI/Eagle SDI)
  external_device: 外部设备型号 (Sony FX6)
  external_device_brand: 品牌 (Sony)
  
  // 测试参数
  interface_type: 接口类型 (全尺寸HDMI A / Micro HDMI D)
  resolution: 分辨率 (1080p / 2160p)
  frame_rate: 帧率 (50 / 59.94)
  
  // 测试结果
  is_compatible: 是否兼容 (✓ / ✕)
  notes: 备注
  
  // 元数据支持 (针对特定类型)
  supports_rec_status: 录制状态显示
  supports_vu_meter: VU表
  supports_timecode: 时码
  
  // 测试信息
  tested_date: 测试日期
  tested_by: 测试人员
  firmware_version: 测试时固件版本
}
```

#### 4.3.6 问题案例结构 (来自Knowledge base_Edge)

```
问题案例 {
  id: 唯一标识
  
  // 问题分类
  category: 问题大类 (稳定性/素材/监看/SSD/...)
  sub_category: 问题小类 (无法开机/死机/画面异常/...)
  
  // 问题描述
  phenomenon: 具体现象
  analysis: 问题分析
  
  // 售后步骤
  service_steps: [售后处理步骤列表]
  
  // 具体案例
  cases: [{
    date: 反馈时间,
    product_model: 机型 (Edge 8K / Edge 6K),
    firmware_version: 固件版本,
    reporter: 反馈人,
    description: 详细描述,
    media_links: [图片/视频链接],
    solution: 解决方法,
    serial_number: 序列号 (可选)
  }]
  
  // 生产工艺变更提示
  manufacturing_notes: 生产工艺变更说明
}
```

#### 4.3.7 固件知识结构

```
固件知识条目 {
  id: 唯一标识
  firmware_version: 固件版本 (如: 8023)
  compare_version: 对比版本 (如: 7314/7318)
  
  // 新功能
  new_features: [{
    name: 功能名称,
    description: 功能说明
  }]
  
  // 问题与解答
  qa_items: [{
    category: 分类 (RAW/ProRes BT.2020/自定义按键/其他),
    question: 问题,
    answer: 答案,
    notes: 备注
  }]
}
```

#### 4.3.8 权限分级

| 可见性 | 说明 | 可见内容 | 内容示例 |
|-------|------|---------|---------|
| **Public** | 完全公开(3.0阶段向终端用户开放) | 外部回答、基础兼容性列表、产品说明书 | MAVO Edge 6K操作说明书 |
| **Dealer** | 经销商可见 | Public + 维修手册、产品知识库 | EAGLE维修手册、Knowledge base_Edge |
| **Internal** | 内部员工 | 全部内容 (含内部回答、敏感资料) | 内部分析报告、成本信息等 |
| **Department** | 特定部门 | 如维修手册仅售后/研发可见 | 生产工艺资料 |

#### 4.3.9 组织方式

采用 **混合模式**：
- **按产品线组织**: Eagle系列 / MAVO Edge系列 / TERRA系列
- **按知识类型组织**: FAQ / Troubleshooting / 兼容性 / 固件知识
- **通用知识库**: 跨产品的通用内容

```
知识库
├── 产品知识
│   ├── Eagle HDMI
│   │   ├── FAQ
│   │   ├── Troubleshooting
│   │   ├── 兼容性列表
│   │   └── 问题案例
│   ├── Eagle SDI
│   ├── MAVO Edge 8K
│   └── ...
├── 固件知识
│   ├── 8.0 (8023)
│   ├── 7.3 (7314)
│   └── ...
└── 通用知识
    ├── SSD使用指南
    ├── 供电方案
    └── ...
```

#### 4.3.10 知识库维护流程

```
创建知识 → 审核 → 发布
             ↓
          修订 → 审核 → 发布新版本
```

**角色权限**:
- **查看者**: 只能浏览
- **编辑者**: 可创建/编辑草稿
- **审核者**: 可审核发布
- **管理员**: 可删除/设置权限

#### 4.3.11 知识库与工单联动

- 创建工单时: 智能推荐相关知识 (基于问题描述)
- 处理工单时: 可引用知识库内容作为解决方案
- 关闭工单时: 可将解决方案沉淀为新知识条目

---

### 4.4 AI 智能问答系统

#### 4.4.1 系统架构

```
用户提问
    ↓
┌─────────────────────────────────────────────┐
│              AI 问答引擎                      │
│  ┌─────────────┐    ┌─────────────────────┐ │
│  │ 本地知识库   │    │   在线知识源         │ │
│  │ (向量检索)   │    │ - 官网文档          │ │
│  │             │    │ - 指定URL爬取       │ │
│  └─────────────┘    └─────────────────────┘ │
│           ↓                   ↓              │
│         上下文整合 + Prompt 构建             │
│                     ↓                        │
│              LLM 生成回答                    │
└─────────────────────────────────────────────┘
    ↓
智能回答 / 引导式 Troubleshooting
```

#### 4.4.2 查询入口设计

| 用户类型 | 查询方式 | 知识范围 |
|---------|---------|---------|
| **公开用户** | 官网聊天窗口 / 小程序 | Public 知识 + 官网内容 |
| **经销商** | 登录后问答入口 | Public + Dealer 知识 |
| **内部员工** | 工单系统内置问答 | 全部知识库 |

**查询模式**:

1. **直接问答模式**
   - 用户输入自然语言问题
   - AI 检索相关知识 + 生成答案
   - 返回: 答案 + 引用来源

2. **引导式 Troubleshooting**
   - 用户描述问题现象
   - AI 逐步询问补充信息
   - 根据排查树引导定位原因
   - 给出解决方案或建议创建工单

3. **传统文档搜索**
   - 关键词搜索知识条目
   - 分类浏览

#### 4.4.3 知识源配置

**本地知识库** (向量化存储):
- 所有知识条目的 Embedding
- 历史工单的问题描述和解决方案
- 产品手册/规格书 (PDF 解析)

**在线知识源** (可配置):
- 官网 FAQ 页面 URL
- 产品页面 URL
- 技术博客/论坛 (如有)
- 定期爬取 + 更新 Embedding

#### 4.4.4 AI 服务商推荐 (低成本方案)

##### 国外方案

| 服务商 | 模型 | 定价 | 优势 | 劣势 |
|-------|------|------|------|------|
| **OpenAI** | GPT-4o-mini | $0.15/1M input, $0.60/1M output | 质量好、稳定 | 需要翻墙 |
| **Google** | Gemini 1.5 Flash | 免费额度: 15 RPM, 超出后 $0.075/1M | 免费额度慷慨 | 国内访问受限 |
| **Anthropic** | Claude 3 Haiku | $0.25/1M input, $1.25/1M output | 长上下文、安全 | 国内访问受限 |
| **Groq** | Llama 3 70B | 免费额度 (有 Rate Limit) | 完全免费、速度极快 | 稳定性待验证 |
| **Together AI** | Llama 3 / Mixtral | $0.20-0.90/1M | 多模型选择 | 小厂 |

##### 国内方案

| 服务商 | 模型 | 定价 | 优势 | 劣势 |
|-------|------|------|------|------|
| **阿里云 通义千问** | Qwen-turbo | ¥0.008/千 tokens | 便宜、国内稳定 | 质量一般 |
| **阿里云 通义千问** | Qwen-max | ¥0.12/千 tokens | 质量好 | 较贵 |
| **百度 文心一言** | ERNIE-Speed | 免费 (有额度) | 完全免费 | 质量一般 |
| **智谱 AI** | GLM-4-Flash | 免费 (限额) | 免费、质量不错 | 限额 |
| **智谱 AI** | GLM-4-Air | ¥0.001/千 tokens | 极便宜 | - |
| **月之暗面 Kimi** | Moonshot-v1-8k | ¥0.012/千 tokens | 长文本能力强 | 新厂商 |
| **DeepSeek** | DeepSeek-chat | ¥0.001/千 tokens | 极便宜、质量好 | 新厂商 |
| **硅基流动 SiliconFlow** | 多模型 | 部分免费 | 聚合平台 | - |

##### 推荐组合

**方案 A: 国内优先 (推荐)**
- 主力: **DeepSeek** 或 **智谱 GLM-4-Air** (极低成本)
- 备用: **通义千问 Qwen-turbo**
- 估算成本: 1000次问答/月 ≈ ¥10-30

**方案 B: 国外优先**
- 主力: **Groq (Llama 3)** 免费额度
- 备用: **OpenAI GPT-4o-mini**
- 估算成本: 免费额度内 ¥0，超出后 $5-20/月

**方案 C: 混合部署**
- 国内用户 → 国内 API (DeepSeek/智谱)
- 海外用户 → 国外 API (Groq/OpenAI)

#### 4.4.5 向量检索方案

| 方案 | 说明 | 成本 | 适用场景 |
|-----|------|------|---------|
| **SQLite + sqlite-vec** | 本地向量扩展 | 免费 | 小规模 (<10万条) |
| **ChromaDB** | 轻量级向量数据库 | 免费 | 中小规模 |
| **Pinecone** | 云向量数据库 | 免费层 + 付费 | 需要高可用 |
| **阿里云 向量检索** | 托管服务 | 按量付费 | 国内部署 |

**推荐**: 先用 **SQLite + sqlite-vec** 或 **ChromaDB**，数据量大了再迁移云服务。

#### 4.4.6 Embedding 模型

| 模型 | 维度 | 成本 | 说明 |
|-----|------|------|------|
| **OpenAI text-embedding-3-small** | 1536 | $0.02/1M tokens | 质量好 |
| **智谱 Embedding-2** | 1024 | 免费额度 | 国内可用 |
| **BGE-M3 (本地)** | 1024 | 免费 | 需要 GPU 或较长时间 |
| **Sentence-Transformers (本地)** | 384-768 | 免费 | CPU 可跑 |

**推荐**: 小规模用 **智谱 Embedding** (免费)，或本地部署 **BGE-M3**

#### 4.4.7 AI 应用场景扩展

> **核心原则**: AI分析/推荐 → 人工确认/选择 → 执行
> 所有AI场景采用"AI建议 + 人工授权"模式，确保人始终掌控决策。

##### 场景 1: 知识库 + 工单联合查询

```
用户提问: "MAVO Edge 8K 录制时突然停止是什么原因？"
    ↓
AI 检索范围:
├── 知识库: FAQ、故障排查指南、产品说明
└── 历史工单: 相似问题的描述、处理过程、解决方案
    ↓
生成答案 (带引用索引):
"根据历史记录，MAVO Edge 8K 录制中断通常有以下原因：
 1. SSD 写入速度不足 [参考: KB-0023, 工单 #IS-2025-0847]
 2. 高温保护触发 [参考: KB-0045]
 3. 电池电量不足 [参考: 工单 #IS-2026-0012, #IS-2026-0089]
 
 建议排查步骤..."
```

**引用索引格式**:
- 知识库: `[KB-{编号}]` → 可点击跳转到知识条目
- 工单: `[工单 #{编号}]` → 可点击跳转到工单详情 (需权限)

##### 场景 2: AI 工单分析

| 分析类型 | 说明 | 输出 |
|---------|------|------|
| **问题模式识别** | 分析近期工单，发现共性问题 | "近30天有12个工单提到'开机黑屏'，集中在批次 2026Q1-003" |
| **趋势预警** | 检测异常增长的问题类型 | "存储相关问题本周增长 200%，建议关注" |
| **根因分析** | 对特定问题进行深入分析 | "批次 X 的问题可能与供应商 Y 的元器件相关" |
| **工单聚类** | 自动将相似工单归类 | 将分散的工单聚合为"同一问题的多个表现" |
| **解决方案推荐** | 基于历史成功案例推荐方案 | "类似问题的 85% 通过固件升级解决" |

##### 场景 3: AI 辅助查询

**智能查询建议**:
```
用户输入: "最近华东地区问题比较多"
    ↓
AI 理解意图 → 生成结构化查询:
  - 地区 = 华东
  - 时间 = 近30天
  - 排序 = 数量降序
    ↓
自动执行查询 + 生成洞察:
"华东地区近30天共 45 个工单，环比增长 30%。
 主要集中在：
 - MAVO Edge 8K (23个，占51%)
 - 问题类型: 存储相关 (18个，占40%)
 建议关注经销商 XX，其问题数量最多 (12个)"
```

**查询优化建议**:
- 用户查询结果过多时: "检测到 500+ 结果，建议添加筛选条件：产品型号 或 时间范围"
- 用户查询无结果时: "未找到结果，建议放宽条件：移除'严重程度=紧急'筛选"

##### 场景 4: AI 自动标签与分类

**自动化处理**:
- 新工单创建时: AI 自动建议分类、严重程度、相关产品
- 工单关闭时: AI 建议提取知识点沉淀到知识库
- 批量处理: AI 识别重复/相似工单，建议合并

##### 场景 5: AI 报告生成

**自动化报告**:
```
用户指令: "帮我生成本月产品质量报告"
    ↓
AI 自动:
├── 汇总本月工单数据
├── 按产品/问题类型/地区分析
├── 对比上月数据，计算环比变化
├── 识别关键问题和趋势
└── 生成结构化报告 (可导出 PDF/Word)
```

##### 场景 6: 多语言智能支持

| 场景 | AI 能力 |
|-----|--------|
| **知识库翻译** | 自动将中文知识翻译为英文/德文/日文 |
| **工单翻译** | 海外经销商提交的英文工单自动翻译展示 |
| **多语言问答** | 用户用英文提问，AI 检索中文知识库，用英文回答 |

#### 4.4.8 AI 集成架构总览

```
┌─────────────────────────────────────────────────────────────────┐
│                        AI 中枢服务                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐     │
│   │  智能问答     │    │  工单分析     │    │  查询辅助     │     │
│   │  - 知识检索   │    │  - 模式识别   │    │  - 意图理解   │     │
│   │  - 工单检索   │    │  - 趋势预警   │    │  - 查询生成   │     │
│   │  - 答案生成   │    │  - 根因分析   │    │  - 结果解读   │     │
│   └──────────────┘    └──────────────┘    └──────────────┘     │
│           │                   │                   │             │
│           └───────────────────┼───────────────────┘             │
│                               ↓                                 │
│   ┌─────────────────────────────────────────────────────────┐  │
│   │                    统一向量检索层                         │  │
│   │   知识库 Embeddings  |  工单 Embeddings  |  产品文档     │  │
│   └─────────────────────────────────────────────────────────┘  │
│                               ↓                                 │
│   ┌─────────────────────────────────────────────────────────┐  │
│   │                      LLM 调用层                          │  │
│   │   DeepSeek / 智谱 / Qwen (国内)  |  Groq / OpenAI (海外) │  │
│   └─────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                               ↑
        ┌──────────────────────┼──────────────────────┐
        ↓                      ↓                      ↓
   ┌─────────┐           ┌─────────┐           ┌─────────┐
   │ Web 端  │           │ iOS 端  │           │ 公开入口 │
   │ (员工)  │           │ (员工)  │           │(用户/经销商)│
   └─────────┘           └─────────┘           └─────────┘
```

#### 4.4.9 AI应用场景汇总

> 详细场景流程见 `IssueTracker_UserScenarios.md` 第9节

**一、工单创建与处理**
| 场景 | AI能力 | 人工操作 | 价值 |
|-----|--------|---------|------|
| 工单智能分类 | 根据问题描述推荐：类别、小类、严重程度 | 一键确认或调整 | 减少手动选择 |
| 优先级智能建议 | 根据客户类型、问题严重性推荐P1-P3/R1-R3 | 确认或调整 | 统一判断标准 |
| 处理人智能分配 | 根据专长、工作量推荐2-3个处理人 | 选择一个 | 均衡工作量 |
| 相似工单识别 | 识别历史相似工单，提示"可能重复" | 确认关联或合并 | 避免重复 |
| 智能回复建议 | 根据问题+知识库生成2-3条回复建议 | 选择/编辑后发送 | 加速响应 |

**二、知识库智能管理**
| 场景 | AI能力 | 人工操作 | 价值 |
|-----|--------|---------|------|
| 知识点自动提取 | 工单关闭时判断是否值得沉淀为知识点 | 确认/编辑后发布 | 自动积累知识 |
| 高频问题识别 | 识别重复出现但无知识库条目的问题 | 确认后生成FAQ草稿 | 发现知识缺口 |
| 知识条目更新建议 | 发现工单有更好方案时提示更新 | 确认更新 | 保持时效性 |

**三、维修与返修流程**
| 场景 | AI能力 | 人工操作 | 价值 |
|-----|--------|---------|------|
| 故障原因诊断 | 根据描述+历史数据推测故障原因(概率排序) | 参考判断 | 辅助远程诊断 |
| 维修方案推荐 | 基于诊断生成维修方案+预估费用 | 确认或调整 | 快速出报价 |
| 批次问题预警 | 发现同批次多个类似问题自动预警 | 确认是否升级 | 早期发现问题 |
| 维修记录规范化 | 规范化用语、补充标准术语 | 确认保存 | 统一记录格式 |

**四、客户沟通**
| 场景 | AI能力 | 人工操作 | 价值 |
|-----|--------|---------|------|
| 邮件/通知起草 | 根据状态变更自动起草通知内容 | 确认/编辑后发送 | 减少重复写作 |
| 多语言翻译 | 自动翻译工单和回复(英↔中) | 确认译文 | 跨语言沟通 |
| 客户情绪识别 | 分析客户描述情绪，提示优先处理 | 参考调整优先级 | 避免投诉升级 |

**五、经销商管理**
| 场景 | AI能力 | 人工操作 | 价值 |
|-----|--------|---------|------|
| 补货量智能建议 | 根据消耗速度、库存水位推荐补货量 | 确认或调整 | 避免断货/积压 |
| 结算异常检测 | 检测异常数据(使用量突增等) | 确认是否需核实 | 防止错误/舞弊 |

**六、统计与报告**
| 场景 | AI能力 | 人工操作 | 价值 |
|-----|--------|---------|------|
| 报告智能摘要 | 自动生成周报/月报关键洞察摘要 | 直接使用或编辑 | 快速抓重点 |
| 异常趋势预警 | 检测指标异常变化，主动推送预警 | 查看并决定处理 | 早期发现问题 |
| 自然语言查询 | 将自然语言转化为结构化查询 | 查看结果 | 降低查询门槛 |

#### 4.4.10 AI实现优先级

**Phase 1 (核心价值，优先实现)**:
1. 工单智能分类 + 优先级建议
2. 智能回复建议
3. 知识点自动提取
4. 故障原因诊断 + 维修方案推荐
5. 报告智能摘要

**Phase 2 (提升效率)**:
6. 高频问题识别
7. 相似工单识别
8. 补货量智能建议
9. 批次问题预警
10. 邮件/通知自动起草

**Phase 3 (深度应用)**:
11. 处理人智能分配
12. 知识条目更新建议
13. 自然语言查询
14. 客户情绪识别
15. 结算异常检测
16. 维修记录规范化
17. 多语言翻译



```
products (产品)
├── id, name, model
├── category (电影机/寻像器/配件/线缆)
├── series (Edge/MM2/Terra/Eagle)
├── current_firmware_version
└── created_at

customers (客户)
├── id, name, company, contact_info
├── customer_type (终端客户/KOL/媒体)
├── customer_level (VIP/普通/新客户)
├── country, province, city
├── dealer_id (关联经销商，可为空)
└── created_at

dealers (经销商/渠道商)
├── id, name, code
├── dealer_type (一级代理/二级代理/直营)
├── region (销售大区: 华东/华南/华北/海外)
├── country, province, city
├── contact_info
└── created_at

users (系统用户 - 员工)
├── id, name, email
├── department (市场部/生产部/研发部/管理层)
├── role (admin/editor/viewer)
├── region_responsible (国内/国外，针对市场部)
└── created_at

inquiry_tickets (咨询工单 - 系统入口)
├── id
├── ticket_number: 工单编号 (自动生成)
│   // 格式：KYYMM-XXXX (如: K2602-0001)
│   // 序号超9999自动转16进制 (0001-FFFF，最大65535/月)
│
├── // 客户信息 (代客户服务模式下可选填写)
├── customer_name: 客户姓名 (可选，不填显示“匿名客户”)
├── customer_contact: 联系方式 (可选)
├── customer_id: 关联客户 (可为空)
├── dealer_id: 关联经销商 (可为空)
│
├── // 产品信息 (可选)
├── product_id: 关联产品 (可为空)
├── serial_number: 序列号 (可为空)
│
├── // 服务内容
├── service_type: 服务类型 (咨询/问题排查/远程协助/投诉)
├── channel: 沟通渠道 (电话/邮件/微信/企业微信)
├── problem_summary: 问题摘要
├── communication_log: 沟通记录 (问题描述 + 处理过程)
├── resolution: 处理结果
│
├── // 处理信息
├── handler_id: 处理人ID
├── handler_name: 处理人姓名
│
├── // 状态管理
├── status: 状态 (处理中/待客户反馈/已解决/自动关闭/转工单)
├── status_changed_at: 最近状态变更时间
├── waiting_customer_since: 进入待反馈状态的时间 (用于计算自动关闭)
│
├── // 时间追踪 (系统自动计算)
├── first_response_at: 首次响应时间
├── first_response_minutes: 首次响应时长(分钟)
├── total_duration_minutes: 总服务时长(分钟)
├── effective_duration_minutes: 有效处理时长(分钟) - 扣除等待时间
├── waiting_duration_minutes: 等待客户反馈累计时长(分钟)
│
├── // 关联
├── related_ticket_id: 升级后的工单ID (RMA或经销商维修单)
├── related_ticket_type: 关联工单类型 (rma/dealer_repair)
├── reopened_from_id: 如是重新打开，原咨询工单ID
│
├── // 自动关闭提醒
├── auto_close_reminder_sent: 是否已发送关闭提醒 (第5天)
├── auto_close_at: 预计自动关闭时间
│
└── created_at, updated_at
```

### 4.2 工单实体 (核心)

```
tickets (工单/RMA返厂单/经销商维修单)
├── id
├── ticket_number: 工单编号 (自动生成)
│   // 格式：见3种类型：
│   // - 咨询工单：KYYMM-XXXX (如: K2602-0001)
│   // - RMA返厂单：RMA-{C}-YYMM-XXXX (如: RMA-D-2602-0015)
│   // - 经销商维修单：SVC-D-YYMM-XXXX (如: SVC-D-2602-0001)
│   // {C} 为渠道代码：D=Dealer(经销商), C=Customer(直客)
│   // XXXX 为流水号：0001-9999(十进制), A000-FFFF(16进制)
├── ticket_type: 工单类型 (inquiry/rma/dealer_repair)
│   // inquiry: 咨询工单
│   // rma: RMA返厂单 (寄回总部维修)
│   // dealer_repair: 经销商维修单 (经销商本地维修)
│
├── // 问题分类
├── issue_type: 来源类型 (生产问题/发货问题/客户返修/内部样机)
├── issue_category: 大类 (稳定性/素材/监看/SSD/音频/兼容性/时码/硬件结构)
├── issue_subcategory: 小类 (无法开机/死机/画面异常/...)
├── severity: 等级 (1级/2级/3级)
│
├── // 产品信息
├── product_id: 关联产品
├── serial_number: 序列号 (如: KVF_104036, ME_207624)
├── firmware_version: 固件版本
├── hardware_version: 硬件版本/批次
│
├── // 问题描述 (市场部填写)
├── problem_description: 问题描述
├── solution_for_customer: 解决方案(对客户)
├── is_warranty: 是否在保
│
├── // 维修信息 (生产部填写)
├── repair_content: 维修内容 (更换了什么部件)
├── problem_analysis: 问题分析 (PCB/芯片分析)
│
├── // 关联人员
├── reporter_name: 反馈人姓名
├── reporter_type: 反馈人类型 (客户/经销商/内部)
├── customer_id: 关联客户 (可为空)
├── dealer_id: 关联经销商 (可为空)
├── region: 地区 (国内/国外/具体国家)
│
├── // 内部负责人
├── submitted_by: 提交人(市场部)
├── assigned_to: 当前处理人(生产部)
├── created_by: 创建人
│
├── // 收款信息
├── payment_channel: 收款渠道 (微信/支付宝/对公转账)
├── payment_amount: 收款金额
├── payment_date: 收款日期
│
├── // 状态与时间
├── status: 状态 (待处理/处理中/已维修/待收款/已关闭)
├── feedback_date: 反馈时间
├── ship_date: 发货日期 (原始发货)
├── received_date: 收货日期 (返修收货)
├── completed_date: 完成日期
│
├── // 外部链接
├── external_link: RMA工单链接 (企业微信文档等)
│
└── created_at, updated_at
```

### 4.3 工单附件

```
issue_attachments (工单附件)
├── id, issue_id
├── file_name, file_path, file_url
├── file_size, file_type (image/video)
├── mime_type
├── uploaded_by
└── created_at
```

### 4.4 工单评论/跟进记录

```
issue_comments (工单评论)
├── id, issue_id
├── comment_type: 类型 (进度更新/内部备注/客户沟通)
├── content: 内容
├── author_id, author_name, author_department
├── is_internal: 是否仅内部可见
└── created_at
```

### 4.5 生产问题反馈 (F0)

```
production_feedbacks (生产问题反馈)
├── id
├── feedback_date: 反馈日期
├── ship_date: 发货日期
├── category: 分类 (生产/发货/返修/检测维修)
├── severity: 等级 (1级/2级/3级)
├── product_name: 反馈产品
├── serial_number: 序列号
├── problem_description: 反馈问题
├── communication_feedback: 沟通反馈
├── reporter: 反馈人/客户
├── responsible_person: 负责人
├── order_responsible: 订单负责人
├── remarks: 备注
├── related_issue_id: 关联工单 (可为空)
└── created_at, updated_at
```

### 4.6 知识库实体

```
knowledge_articles (知识库条目)
├── id, article_number (如: KB-0023)
├── title: 标题
├── knowledge_type: 类型 (FAQ/Troubleshooting/兼容性/固件知识/基础知识/问题案例/维修手册)
│
├── // FAQ特有
├── question: 问题 (FAQ类型)
├── external_answer: 外部回答
├── internal_answer: 内部回答
│
├── // 通用
├── content: 正文内容 (Markdown)
├── visibility: 可见性 (Public/Dealer/Internal/Department)
│
├── // 关联
├── related_issues: [关联工单ID列表]
├── firmware_version: 相关固件版本
│
├── // 版本控制
├── version, status (draft/published)
├── created_by, updated_by
└── created_at, updated_at

knowledge_products (知识-产品关联)
├── knowledge_id, product_id

knowledge_tags (知识标签)
├── knowledge_id, tag

troubleshooting_steps (故障排查步骤)
├── id, knowledge_id
├── step_order: 步骤顺序
├── action: 操作内容
├── result_if_pass: 通过后结果
├── result_if_fail: 失败后结果
├── next_step_if_fail: 失败后下一步

compatibility_entries (兼容性条目)
├── id, knowledge_id
├── our_product: 我方产品
├── external_device: 外部设备
├── external_brand: 外部品牌
├── interface_type, resolution, frame_rate
├── is_compatible: 是否兼容
├── supports_rec_status, supports_vu, supports_timecode
├── notes, tested_date, tested_by
```

### 4.7 经销商配件库存管理

```
dealer_inventory (经销商配件库存)
├── id
├── dealer_id: 经销商ID
├── sku: 配件SKU
├── sku_name: 配件名称
├── quantity: 当前数量
├── safety_stock: 安全库存线
├── last_replenishment_date: 上次补货日期
├── last_replenishment_quantity: 上次补货数量
└── created_at, updated_at

dealer_inventory_transactions (库存变动记录)
├── id
├── dealer_id: 经销商ID
├── sku: 配件SKU
├── transaction_type: 变动类型 (初始化/补货/使用/退回/调整)
├── quantity_change: 变动数量 (+/-)
├── quantity_before: 变动前数量
├── quantity_after: 变动后数量
├── related_issue_id: 关联工单 (使用时)
├── related_replenishment_id: 关联补货单 (补货时)
├── reason: 变动原因
├── operator_id: 操作人
└── created_at

replenishment_requests (补货申请)
├── id
├── request_number: 补货单号 (如: REP-2026-001)
├── dealer_id: 经销商ID
├── status: 状态 (待审核/审核中/已通过/已拒绝/已发货/已收货)
│
├── // 申请内容
├── items: [{ sku, quantity, reason }] JSON数组
├── total_items: 总品类数
├── total_quantity: 总数量
│
├── // 欠款检查
├── outstanding_amount: 申请时未结清金额
├── outstanding_age_days: 最长欠款账龄
├── debt_check_passed: 欠款检查是否通过
│
├── // 审核信息
├── approved_by: 审核人
├── approved_at: 审核时间
├── approval_note: 审核备注
├── is_emergency: 是否紧急例外
│
├── // 发货信息
├── shipped_at: 发货时间
├── tracking_number: 快递单号
├── received_at: 收货确认时间
│
├── created_by: 申请人
└── created_at, updated_at
```

### 4.8 维修发票与结算

```
repair_invoices (维修发票/PI)
├── id
├── invoice_number: 发票编号 (如: PI-2026-0001)
├── invoice_date: 开票日期
│
├── // 关联信息
├── dealer_id: 经销商ID (经销商结算时)
├── customer_id: 客户ID (散户时)
├── issue_id: 关联工单
├── rma_number: RMA号
│
├── // 产品信息
├── product_model: 产品型号
├── serial_number: 序列号
├── warranty_status: 保修状态 (在保/过保)
│
├── // 费用明细
├── items: [{ sku, name, quantity, unit_price, subtotal }] JSON
├── parts_total: 配件总费用
├── labor_fee: 人工费
├── shipping_fee: 运费
├── other_fee: 其他费用
├── total_amount: 总金额
├── currency: 货币 (USD/EUR/CNY)
│
├── // 地址信息
├── bill_to_address: 账单地址 JSON
├── ship_to_address: 收货地址 JSON
│
├── // 问题描述
├── problem_description: 问题描述
├── analysis: 原因分析
├── solution: 解决方案
│
├── // 状态
├── status: 状态 (草稿/已发送/待付款/已付款/已取消)
├── sent_at: 发送时间
├── paid_at: 付款时间
├── payment_method: 付款方式
│
├── created_by: 创建人
└── created_at, updated_at

dealer_settlements (经销商定期结算)
├── id
├── settlement_number: 结算单号
├── dealer_id: 经销商ID
├── period_start: 结算周期开始
├── period_end: 结算周期结束
├── settlement_type: 结算类型 (月度/季度)
│
├── // 汇总
├── total_repairs: 维修工单数
├── total_parts_used: 配件使用总数
├── total_amount: 结算总金额
├── currency: 货币
│
├── // 明细
├── invoice_ids: [关联PI列表]
├── detail_items: [{ sku, quantity, amount }] JSON
│
├── // 状态
├── status: 状态 (待确认/已确认/待付款/已付款)
├── confirmed_at: 经销商确认时间
├── paid_at: 付款时间
│
└── created_at, updated_at
```

### 4.9 物流追踪

```
logistics_tracking (物流追踪)
├── id
├── issue_id: 关联工单
├── rma_number: RMA号
├── direction: 方向 (inbound-寄回/outbound-寄出)
│
├── // 物流类型
├── logistics_type: 类型 (快递/上门送达/Kine取件/集中发货)
│
├── // 快递信息
├── carrier: 快递公司 (DHL/FedEx/UPS/顺丰/京东)
├── tracking_number: 快递单号
├── is_tracking_pending: 是否待补填
│
├── // 地址
├── origin_region: 发货地区
├── origin_address: 发货地址 JSON
├── destination_address: 收货地址 JSON
│
├── // 时间
├── shipped_at: 发货时间
├── estimated_arrival: 预估到达时间
├── actual_arrival: 实际到达时间
├── received_at: 签收确认时间
│
├── // 上门送达特有
├── appointment_time: 预约送达时间
├── contact_person: 联系人
├── contact_phone: 联系电话
│
├── // 集中发货特有
├── related_rma_numbers: [关联的其他RMA号]
│
├── // 状态
├── status: 状态 (待发货/运输中/已到达/已签收)
├── status_history: [状态变更历史] JSON
│
├── created_by: 创建人
└── created_at, updated_at
```

### 4.10 维修异常处理

```
repair_exceptions (维修异常)
├── id
├── issue_id: 关联工单
├── exception_number: 异常编号 (如: EXC-2026-001)
│
├── // 异常类型
├── exception_type: 类型 (成本超预估/严重损坏/需换整机/人为损坏/无法修复/发现其他问题)
│
├── // 原预估
├── original_estimate: 原预估金额
├── original_estimate_detail: 原预估明细 JSON
│
├── // 实际情况
├── actual_estimate: 实际需要金额
├── actual_estimate_detail: 实际明细 JSON
├── difference_amount: 差异金额
├── difference_percentage: 差异百分比
│
├── // 问题描述
├── description: 异常描述
├── photos: [检测照片URL列表]
├── analysis: 原因分析
│
├── // 客户选择
├── customer_options: [可选方案] JSON
│   // 如: [{type:'continue', amount:2500}, {type:'cancel', amount:0}, {type:'trade_in', amount:4000}]
├── customer_choice: 客户选择 (continue/cancel/trade_in/scrap)
├── customer_choice_at: 客户选择时间
├── customer_note: 客户备注
│
├── // 审批
├── requires_approval: 是否需要审批
├── approval_level: 审批级别 (业务员/负责人/管理层)
├── approved_by: 审批人
├── approved_at: 审批时间
├── approval_note: 审批备注
│
├── // 状态
├── status: 状态 (待处理/待客户确认/待审批/已确认/已取消)
│
├── reported_by: 提交人 (生产部)
├── handled_by: 处理人 (市场部)
└── created_at, updated_at
```

### 4.11 定期报告配置

```
report_schedules (报告配置)
├── id
├── report_type: 报告类型 (dealer_inventory_weekly/dealer_repair_monthly/quality_monthly/etc)
├── report_name: 报告名称
├── frequency: 频率 (daily/weekly/monthly)
├── schedule_day: 执行日 (周几/每月几号)
├── schedule_time: 执行时间
│
├── // 收件人
├── recipients: [收件人用户ID列表]
├── recipient_emails: [额外邮箱列表]
│
├── // 推送方式
├── push_email: 是否邮件推送
├── push_app: 是否App推送
├── push_web: 是否Web站内信
│
├── // 报告参数
├── parameters: { 报告特定参数 } JSON
│
├── is_active: 是否启用
├── last_run_at: 上次执行时间
├── last_run_status: 上次执行状态
│
└── created_at, updated_at

report_history (报告历史)
├── id
├── schedule_id: 报告配置ID
├── report_type: 报告类型
├── period_start: 报告周期开始
├── period_end: 报告周期结束
├── generated_at: 生成时间
│
├── // 报告内容
├── summary: 摘要 (AI生成)
├── content_html: 内容HTML
├── data_snapshot: 数据快照 JSON
│
├── // 推送记录
├── push_status: { email: 'sent', app: 'sent' } JSON
│
└── created_at
```

### 4.12 AI建议记录

```
ai_suggestions (AI建议记录)
├── id
├── suggestion_type: 建议类型 (classification/priority/assignee/reply/knowledge/diagnosis/etc)
├── related_entity_type: 关联实体类型 (issue/knowledge/replenishment/etc)
├── related_entity_id: 关联实体ID
│
├── // 建议内容
├── suggestions: [{ option, confidence, reason }] JSON数组
├── recommended_index: 推荐的选项索引
│
├── // 用户操作
├── user_action: 用户操作 (accepted/modified/rejected/ignored)
├── user_choice: 用户最终选择
├── user_modification: 用户修改内容
├── action_by: 操作人
├── action_at: 操作时间
│
├── // AI元数据
├── model_used: 使用的AI模型
├── prompt_version: Prompt版本
├── processing_time_ms: 处理耗时
│
└── created_at
```

### 4.13 统计视图 (预计算)

```
issue_stats_daily (每日统计)
├── date, product_id, issue_category, severity
├── region, dealer_id
├── count, avg_response_time, avg_resolve_time

issue_stats_monthly (月度统计)
├── 同上，按月聚合

product_quality_stats (产品质量统计)
├── product_id, period (周/月/季)
├── total_issues, severity_1_count, severity_2_count, severity_3_count
├── top_categories: [问题类别TOP5]
├── avg_repair_time
```

### 4.14 维修配件SKU与价格

> 数据来源: docs/inputs/维修配件SKU&价格单.xlsx

```
parts_catalog (配件目录)
├── id
├── sku: SKU编码 (如: S2-119-012-01)
├── category: 产品分类 (EAGLE EVF/MAVO Edge/MAVO mark2/Terra等)
├── internal_name_cn: 内部名称-中文
├── internal_name_en: 内部名称-英文
├── external_name_cn: 对外名称-中文
├── external_name_en: 对外名称-英文
├── price_cny: 人民币价格
├── price_usd: 美元价格
├── price_eur: 欧元价格
├── is_active: 是否在售
├── remarks: 备注
└── created_at, updated_at
```

**配件价格范围 (USD)**:
| 类别 | 价格范围 | 典型配件 |
|-----|---------|---------|
| 传感器 | $1,599 - $2,499 | Edge 8K Sensor, Edge 6K Sensor |
| 主板 | $799 - $1,199 | Main Board, MC图像处理模块 |
| 功能模块 | $59 - $750 | ND模块, SDI模块, 显示模块 |
| 小配件 | $19 - $120 | 风扇, TF卡模块, 按键板 |

**SKU编码规则**:
- 格式: `Sx-xxx-xxx-xx`
- S1: MAVO系列配件
- S2: EAGLE系列配件
- S3: 通用电路板
- S4: 通用小配件
- B-: 外壳/结构件

### 3.15 客户功能期望 (Wishlist)

> 收集客户对产品的改进建议和功能期望，形成产品迭代的重要输入

**与其他模块的关系**:
| 模块 | 性质 | 处理方式 |
|-----|------|---------|
| 咨询工单 | 咨询/排查 | 解答后关闭 |
| RMA返厂单 | 产品故障 | 维修闭环 |
| **功能期望** | 产品改进建议 | 需求管理→产品迭代→推送闭环 |

```
feature_requests (功能期望)
├── id
├── request_number: 编号 (FR-2026-0001)
├── title: 标题
├── description: 详细描述
├── category: 分类 (UI/功能/性能/兼容性/硬件/其他)
├── product_id: 相关产品
│
├── // 来源追溯
├── source_type: 来源类型 (咨询工单/经销商反馈/客户自助/内部建议)
├── source_id: 来源记录ID
├── customer_id: 首次提出客户
│
├── // 优先级与投票
├── priority: 优先级 (高/中/低)
├── vote_count: 请求次数/投票数
│
├── // 状态管理
├── status: 状态 (新建/评估中/已规划/开发中/已发布/已拒绝/已合并)
├── assigned_to: 负责人 (研发/产品)
├── rejection_reason: 拒绝原因
├── merged_to_id: 合并到哪个需求ID
│
├── // 版本规划
├── target_version: 目标版本 (如: 固件8025)
├── released_version: 实际发布版本
├── release_date: 发布日期
│
├── // AI辅助
├── ai_tags: AI自动标签
├── ai_similar_ids: AI识别的相似需求ID列表
├── ai_priority_score: AI优先级评分
│
└── created_at, updated_at

feature_request_customers (需求-客户关联)
├── id
├── feature_request_id: 功能期望ID
├── customer_id: 客户ID
├── dealer_id: 经销商ID (如通过经销商提交)
├── source_record_id: 来源记录ID (咨询工单/RMA工单)
├── vote_comment: 投票备注
├── notified_at: 功能发布后推送时间
├── notification_opened: 是否打开通知
├── feedback: 客户反馈
└── created_at

feature_request_comments (需求评论)
├── id
├── feature_request_id
├── author_id, author_name
├── comment_type: 类型 (评估意见/技术分析/产品决策)
├── content: 内容
└── created_at
```

**状态流转**:
```
新建 → 评估中 → 已规划 → 开发中 → 已发布
          ↘ 已拒绝 (附原因)
          ↘ 已合并 (合并到其他需求)
```

**AI介入点**:
| 环节 | AI能力 | 说明 |
|-----|-------|------|
| 收集 | 自动识别 | 从咨询工单中识别“希望/建议/能不能”等关键词 |
| 整理 | 自动分类 | 根据描述自动分类为 UI/功能/性能/兼容性 |
| 整理 | 相似聚合 | 识别重复需求，建议合并 |
| 评估 | 优先级建议 | 根据请求频次、客户重要性给出建议 |
| 闭环 | 智能匹配 | 发布新版本时，自动匹配相关需求和客户 |

**推送闭环机制**:
```
固件发布 → 查找target_version匹配的需求 
        → 找出相关客户 (feature_request_customers)
        → 推送通知: "您期望的XXX功能已在固件8025中发布！"
        → 记录推送状态和客户反馈
```

---

## 5. 需求确认记录 (2026-01-30)

### 5.1 查询统计

| 问题 | 决策 | 备注 |
|-----|------|------|
| 预置查询模板 | ✅ 需要 | 初期提供基础模板，后续可动态增加 |
| 定时邮件推送 | ✅ 需要 | **推送对象**: 部门负责人<br>**频率**: 每周/每月/每季度 |
| 自定义报表 | ⏳ Backlog | 后续版本实现 |
| 地区热力图 | ✅ 需要 | Phase 2 实现 |

### 5.2 媒体管理

| 问题 | 决策 | 备注 |
|-----|------|------|
| 视频大小限制 | **50MB** | 原100MB调整为50MB |
| 自动压缩 | ⏳ Backlog | 暂不实现，后续考虑 |
| 对象存储 | ❌ 暂不使用 | 使用内部SSD存储<br>当前仅服务经销商/员工内部使用<br>后续扩展到客户时再考虑OSS |

### 5.3 知识库

| 问题 | 决策 | 备注 |
|-----|------|------|
| 组织方式 | **混合模式** | 按产品 + 按分类 |
| 版本控制 | ❌ 不需要 | 简化实现 |
| 审核流程 | ✅ 需要 | **需要实现推送提醒** (iOS/Web端) |
| 内容格式 | **Markdown/富文本** | 支持Markdown，可选富文本编辑器 |
| 对外发布 | ⏳ 后续考虑 | 需要API接口支持官网集成 |
| 浏览方式 | ✅ WIKI式浏览 | 提供类似WIKI的分类浏览+搜索 |

### 6.4 权限与角色

| 问题 | 决策 | 备注 |
|-----|------|------|
| 经销商登录入口 | ✅ 独立入口 | 可嵌入现有 dealer.kinefinity.com<br>或作为统一Web的特殊角色访问 |
| 经销商创建工单 | ✅ 可以 | 可代客户创建，也可创建自有产品工单 |
| 部门级权限 | ✅ 需要 | 支持后续扩展到更多部门 |

### 6.5 平台分工

| 问题 | 决策 | 备注 |
|-----|------|------|
| Web/iOS边界 | 见下方详细划分 | |
| 推送通知 | ✅ 需要 | 工单状态变更、新工单分配、审核提醒等 |

#### Web端与iOS端功能划分

| 功能模块 | Web端 | iOS端 | 说明 |
|---------|:-----:|:-----:|------|
| **工单创建** | ✅ 完整表单 | ✅ 简化快速录入 | iOS侧重拍照+语音输入 |
| **工单列表** | ✅ 复杂筛选+表格视图 | ✅ 卡片列表+基础筛选 | Web适合批量处理 |
| **工单详情** | ✅ 完整信息+编辑 | ✅ 查看+快速更新状态 | iOS侧重移动场景 |
| **附件上传** | ✅ 文件选择+批量 | ✅ 拍照+相册 | iOS体验更佳 |
| **统计报表** | ✅ 完整图表+交叉分析 | 📊 简化数据大盘 | Web为主，iOS看概览 |
| **知识库管理** | ✅ 创建/编辑/审核 | ❌ 仅查阅 | 编辑在Web端完成 |
| **知识库查阅** | ✅ 完整浏览+搜索 | ✅ 搜索+查看 | 双端支持 |
| **AI问答** | ✅ 完整对话 | ✅ 快速问答 | 双端支持 |
| **用户管理** | ✅ 完整Admin功能 | ✅ 授权/基础管理 | iOS支持授权操作 |
| **系统配置** | ✅ 字典/规则配置 | ✅ 基础配置 | 双端支持 |
| **推送通知** | ✅ 站内通知 | ✅ 系统推送(APNs) | |
| **离线支持** | ❌ | ✅ 草稿暂存 | iOS支持离线草稿 |

**经销商入口方案**: 统一Web+角色区分（方案B）
- 经销商通过统一入口登录，系统自动识别角色
- 显示经销商专属界面和数据范围
- 后续可通过SSO对接到现有dealer.kinefinity.com

**核心原则**:
- **Web端**: 管理中心，适合办公室场景，复杂操作、批量处理、数据分析
- **iOS端**: 移动助手，适合外出/现场场景，快速录入、拍照上传、状态更新、知识查询、授权管理

---

## 6. 版本规划

### Phase 1: 基础工单系统 ✅ 已完成
- [x] 工单 CRUD
- [x] 基础查询筛选
- [x] 图片/视频上传 (本地存储, 50MB限制)
- [x] 简单统计 (数量/状态分布)
- [x] 经销商管理
- [x] RMA号生成

### Phase 2: 高级查询与统计
- [ ] 多维度组合查询
- [ ] 交叉分析报表
- [ ] 地区热力图
- [ ] Excel/PDF 导出
- [ ] 预置查询模板

### Phase 3: 知识库系统
- [ ] 知识条目CRUD (Markdown/富文本)
- [ ] 混合组织模式 (产品+分类)
- [ ] 权限分级 (Public/Dealer/Internal/Department)
- [ ] 审核流程 + 推送提醒
- [ ] 工单-知识联动
- [ ] WIKI式浏览界面
- [ ] 对外API接口

### Phase 4: 返修管理闭环
- [ ] **返修报价预估**
  - [ ] AI故障诊断（概率排序）
  - [ ] 预估价格生成
  - [ ] 客户确认流程
  - [ ] 超时提醒机制（7/14/30天）
- [ ] **物流追踪**
  - [ ] 快递单号管理（已填写/待补填/上门/取件/集中）
  - [ ] 预估收货时间
  - [ ] 自动通知（发货/到达）
- [ ] **维修异常处理**
  - [ ] 异常类型定义（6种）
  - [ ] 生产部→市场部→客户沟通流程
  - [ ] 客户选择（继续/取消/换新/报废）
  - [ ] 审批权限控制（<$100/$100-500/>$500）

### Phase 5: 经销商配件管理
- [ ] **配件库存管理**
  - [ ] 库存初始化
  - [ ] 维修工单自动扣减
  - [ ] 库存预警机制（黄/红）
  - [ ] 库存变动记录
- [ ] **补货申请**
  - [ ] 经销商申请补货
  - [ ] 欠款检查机制（<30天警告/≥30天阻止）
  - [ ] 市场部审批
  - [ ] 紧急例外审批（Cathy）
- [ ] **结算管理**
  - [ ] PI发票生成
  - [ ] 定期结算（月度/季度）
  - [ ] 对账单生成
  - [ ] 欠款催收

### Phase 6: 知识库智能查询（AI辅助）
- [ ] 知识库向量检索
- [ ] 工单历史检索
- [ ] 智能问答 (带引用)
- [ ] 引导式故障排查
- [ ] 工单智能分析

### Phase 7: AI辅助功能 (第一批)
> 详见 UserScenarios.md 第11节 AI实现优先级

- [ ] 工单智能分类 + 优先级建议
- [ ] 智能回复建议
- [ ] 知识点自动提取
- [ ] 故障原因诊断 + 维修方案推荐
- [ ] 报告智能摘要

### Phase 8: 定期报告与通知
- [ ] **定期自动报告**
  - [ ] 经销商库存周报
  - [ ] 经销商维修月报
  - [ ] 工单处理周报
  - [ ] 产品质量月报
  - [ ] 报告邮件推送（富文本HTML，不生成PDF）
- [ ] **推送通知**
  - [ ] iOS APNs推送
  - [ ] Web站内通知
  - [ ] 库存预警通知
  - [ ] 欠款预警通知
  - [ ] 物流状态通知
  - [ ] 维修异常通知

### Phase 9: iOS端开发
- [ ] 工单快速创建（拍照+语音）
- [ ] 工单列表查看
- [ ] 状态快速更新
- [ ] AI问答
- [ ] 推送通知接收
- [ ] 知识库查阅

### Phase 10: AI辅助功能 (第二批)
- [ ] 高频问题识别
- [ ] 相似工单识别
- [ ] 补货量智能建议
- [ ] 批次问题预警
- [ ] 邮件/通知自动起草

### Phase 11: AI辅助功能 (第三批)
- [ ] 处理人智能分配
- [ ] 知识条目更新建议
- [ ] 自然语言查询
- [ ] 客户情绪识别
- [ ] 结算异常检测
- [ ] 维修记录规范化
- [ ] 多语言翻译

### Backlog
- [ ] 自定义报表功能
- [ ] 图片/视频自动压缩
- [ ] 对象存储迁移 (OSS/S3)
- [ ] 官网集成
- [ ] 经销商iOS端
- [ ] 物流API对接（自动追踪）
- [ ] 信用额度管理

---

## 7. 推送通知场景汇总

| 事件 | 推送对象 | 推送方式 | 优先级 |
|-----|---------|---------|-------|
| 新工单创建 | 市场部负责人(按地区) | iOS + Web | 普通 |
| 工单分配给我 | 被分配人 | iOS + Web | 普通 |
| 工单状态变更 | 创建者、关注者 | iOS + Web | 普通 |
| 工单有新评论 | 相关人员 | Web | 低 |
| P1紧急工单/R1加急返修 | 管理层 | iOS (紧急) | 紧急 |
| 生产问题反馈 | 研发部、管理层 | iOS + Web | 高 |
| 知识审核请求 | 审核人 | iOS + Web | 普通 |
| 审核结果 | 创建者 | Web | 低 |
| 定时报表 | 部门负责人 | 邮件 + Web | 低 |
| 工单响应超时 | 负责人、管理层 | iOS + Web | 高 |
| 返修超时预警 | 生产部、市场部 | iOS + Web | 高 |
| **库存预警** | 市场部对应人员 | 邮件 + App | 普通 |
| **经销商库存周报** | 市场部负责人、Cathy | 邮件 + Web | 低 |
| **欠款预警** | 市场部、财务 | 邮件 + Web | 高 |
| **物流发货通知** | 市场部、生产部 | App + Web | 普通 |
| **物流到达通知** | 生产部 | App + Web | 普通 |
| **维修异常通知** | 市场部、经销商 | App + Web | 紧急 |
| **报价确认提醒** | 客户/经销商 | 邮件 + Web | 普通 |
| **报价确认超时(7/14天)** | 客户/经销商、市场部 | 邮件 + Web | 高 |
| **补货审批请求** | 市场部 | App + Web | 普通 |
| **AI知识点建议** | 市场部 | Web | 低 |
| **AI批次问题预警** | 研发部、管理层 | App + Web | 紧急 |
| **AI客户情绪预警** | 市场部负责人 | App | 紧急 |

---

## 8. 需求确认记录(补充)

### 8.1 查询统计 (2026-01-30)

| 问题 | 决策 | 备注 |
|-----|------|------|
| 预置查询模板 | ✅ 需要 | 初期提供基础模板，后续可动态增加 |
| 定时邮件推送 | ✅ 需要 | **推送对象**: 部门负责人<br>**频率**: 每周/每月/每季度 |
| 自定义报表 | ⏳ Backlog | 后续版本实现 |
| 地区热力图 | ✅ 需要 | Phase 2 实现 |

### 8.2 媒体管理 (2026-01-30)

| 问题 | 决策 | 备注 |
|-----|------|------|
| 视频大小限制 | **50MB** | 原100MB调整为50MB |
| 自动压缩 | ⏳ Backlog | 暂不实现，后续考虑 |
| 对象存储 | ❌ 暂不使用 | 使用内部SSD存储 |

### 8.3 知识库 (2026-01-30)

| 问题 | 决策 | 备注 |
|-----|------|------|
| 组织方式 | **混合模式** | 按产品 + 按分类 |
| 版本控制 | ❌ 不需要 | 简化实现 |
| 审核流程 | ✅ 需要 | 需要推送提醒 |
| 内容格式 | **Markdown/富文本** | |

### 9.4 返修管理 (2026-01-31)

| 问题 | 决策 | 备注 |
|-----|------|------|
| 返修报价预估 | ✅ AI分析+客户确认 | 过保必须确认后才能寄修 |
| 检测费 | **$0** | 暂时免费，后续可调整 |
| 客户反悔处理 | ✅ 可退回 | 确认后不寄修，原设备退回，不收费 |
| 确认超时 | **7/14/30天** | 7天提醒→14天跟进→30天关闭 |
| 物流追踪 | ✅ 多种模式 | 快递/上门/取件/集中 |
| 维修异常 | ✅ 三方确认 | 生产部→市场部→客户 |
| 审批权限 | 分级 | <$100业务员/$100-500负责人/>$500管理层 |

### 9.5 经销商配件管理 (2026-01-31)

| 问题 | 决策 | 备注 |
|-----|------|------|
| 库存管理方式 | **系统自动计算** | 无需经销商手动申报 |
| 库存变动 | 维修工单自动扣减 | 工单中选择使用配件 |
| 补货欠款检查 | ✅ 强制检查 | <30天警告，≥30天阻止 |
| 信用额度 | 仅特殊经销商 | 普通经销商付款才发货 |
| 紧急例外 | ✅ 支持 | Cathy审批 |

### 9.6 报告与通知 (2026-01-31)

| 问题 | 决策 | 备注 |
|-----|------|------|
| 报告格式 | **富文本HTML邮件** | 不生成PDF附件 |
| 报告频率 | 日/周/月可配置 | 不同报告不同频率 |
| 推送方式 | 邮件+App+站内信 | 多渠道 |

### 9.7 AI应用 (2026-01-31)

| 问题 | 决策 | 备注 |
|-----|------|------|
| AI应用原则 | **AI建议+人工确认** | 人始终掌控决策 |
| 实现优先级 | 3个Phase | Phase 7/10/11 |
| AI场景总数 | **17个** | 见UserScenarios.md第9节 |

---

**文档状态**: 需求已更新，待API设计
**最后更新**: 2026-02-03
